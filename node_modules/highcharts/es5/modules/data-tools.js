/*
 Highcharts JS v11.1.0 (2023-09-05)

 Highcharts

 (c) 2010-2023 Highsoft AS

 License: www.highcharts.com/license
*/
'use strict';(function(l){"object"===typeof module&&module.exports?(l["default"]=l,module.exports=l):"function"===typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(p){l(p);l.Highcharts=p;return l}):l("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(l){function p(k,g,h,f){k.hasOwnProperty(g)||(k[g]=f.apply(null,h),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:g,module:k[g]}})))}l=l?l._modules:
{};p(l,"Data/Modifiers/DataModifier.js",[l["Core/Utilities.js"]],function(k){var g=k.addEvent,h=k.fireEvent,f=k.merge;k=function(){function e(){}e.prototype.benchmark=function(c,b){function a(){m.modifyTable(c);m.emit({type:"afterBenchmarkIteration"})}var d=[],m=this,n=f({iterations:1},b).iterations;m.on("afterBenchmarkIteration",function(){d.length===n?m.emit({type:"afterBenchmark",results:d}):a()});var t=0,e=0;m.on("modify",function(){t=window.performance.now()});m.on("afterModify",function(){e=
window.performance.now();d.push(e-t)});a();return d};e.prototype.emit=function(c){h(this,c.type,c)};e.prototype.modify=function(c,b){var a=this;return new Promise(function(d,m){c.modified===c&&(c.modified=c.clone(!1,b));try{d(a.modifyTable(c,b))}catch(n){a.emit({type:"error",detail:b,table:c}),m(n)}})};e.prototype.modifyCell=function(c){return this.modifyTable(c)};e.prototype.modifyColumns=function(c){return this.modifyTable(c)};e.prototype.modifyRows=function(c){return this.modifyTable(c)};e.prototype.on=
function(c,b){return g(this,c,b)};return e}();(function(e){e.types={};e.registerType=function(c,b){return!!c&&!e.types[c]&&!!(e.types[c]=b)}})(k||(k={}));return k});p(l,"Data/DataTable.js",[l["Core/Utilities.js"]],function(k){var g=k.addEvent,h=k.fireEvent,f=k.uniqueKey;k=function(){function e(c){void 0===c&&(c={});this.aliases={};this.autoId=!c.id;this.columns={};this.id=c.id||f();this.modified=this;this.rowCount=0;this.versionTag=f();for(var b=c.columns||{},a=Object.keys(b),d=this.columns,m=0,n=
0,t=a.length,e,y;n<t;++n)y=a[n],e=b[y].slice(),d[y]=e,m=Math.max(m,e.length);n=0;for(t=a.length;n<t;++n)d[a[n]].length=m;this.rowCount=m;c=c.aliases||{};b=Object.keys(c);a=this.aliases;n=0;for(t=b.length;n<t;++n)d=b[n],a[d]=c[d]}e.isNull=function(c){if(c===e.NULL)return!0;if(c instanceof Array){if(!c.length)return!1;for(var b=0,a=c.length;b<a;++b)if(null!==c[b])return!1}else{var d=Object.keys(c);if(!d.length)return!1;b=0;for(a=d.length;b<a;++b)if(null!==c[d[b]])return!1}return!0};e.prototype.clone=
function(c,b){var a={};this.emit({type:"cloneTable",detail:b});c||(a.aliases=this.aliases,a.columns=this.columns);this.autoId||(a.id=this.id);a=new e(a);c||(a.versionTag=this.versionTag);this.emit({type:"afterCloneTable",detail:b,tableClone:a});return a};e.prototype.deleteColumnAlias=function(c){var b,a=this.aliases[c],d=this.modifier;a&&(delete this.aliases[c],d&&d.modifyColumns(this,(b={},b[a]=Array(this.rowCount),b),0));return a};e.prototype.deleteColumns=function(c,b){var a=this.columns,d={},
m={},n=this.modifier,t=this.rowCount;c=c||Object.keys(a);if(c.length){this.emit({type:"deleteColumns",columnNames:c,detail:b});for(var e=0,f=c.length,g,u;e<f;++e){u=c[e];if(g=a[u])d[u]=g,m[u]=Array(t);delete a[u]}Object.keys(a).length||(this.rowCount=0);n&&n.modifyColumns(this,m,0,b);this.emit({type:"afterDeleteColumns",columns:d,columnNames:c,detail:b});return d}};e.prototype.deleteRows=function(c,b,a){void 0===b&&(b=1);var d=[],m=[],n=this.modifier;this.emit({type:"deleteRows",detail:a,rowCount:b,
rowIndex:c||0});"undefined"===typeof c&&(c=0,b=this.rowCount);if(0<b&&c<this.rowCount)for(var t=this.columns,e=Object.keys(t),f=0,g=e.length,u,h;f<g;++f){u=t[e[f]];h=u.splice(c,b);f||(this.rowCount=u.length);u=0;for(var q=h.length;u<q;++u)d[u]=d[u]||[],d[u][f]=h[u];m.push(Array(g))}n&&n.modifyRows(this,m,c||0,a);this.emit({type:"afterDeleteRows",detail:a,rowCount:b,rowIndex:c||0,rows:d});return d};e.prototype.emit=function(c){switch(c.type){case "afterDeleteColumns":case "afterDeleteRows":case "afterSetCell":case "afterSetColumns":case "afterSetRows":this.versionTag=
f()}h(this,c.type,c)};e.prototype.getCell=function(c,b){c=this.aliases[c]||c;if(c=this.columns[c])return c[b]};e.prototype.getCellAsBoolean=function(c,b){c=this.aliases[c]||c;c=this.columns[c];return!(!c||!c[b])};e.prototype.getCellAsNumber=function(c,b,a){c=this.aliases[c]||c;b=(c=this.columns[c])&&c[b];switch(typeof b){case "boolean":return b?1:0;case "number":return isNaN(b)&&!a?null:b}b=parseFloat("".concat(b));return isNaN(b)&&!a?null:b};e.prototype.getCellAsString=function(c,b){c=this.aliases[c]||
c;c=this.columns[c];return"".concat(c&&c[b])};e.prototype.getColumn=function(c,b){return this.getColumns([c],b)[c]};e.prototype.getColumnAliases=function(){for(var c=this.aliases,b=Object.keys(c),a={},d=0,m=b.length,n;d<m;++d)n=b[d],a[n]=c[n];return a};e.prototype.getColumnAsNumbers=function(c,b){var a=this.columns;c=this.aliases[c]||c;a=a[c];var d=[];if(a){var m=a.length;if(b)for(b=0;b<m;++b)d.push(this.getCellAsNumber(c,b,!0));else{b=0;for(var n;b<m;++b){n=a[b];if("number"===typeof n)return a.slice();
if(null!==n&&"undefined"!==typeof n)break}for(b=0;b<m;++b)d.push(this.getCellAsNumber(c,b))}}return d};e.prototype.getColumnNames=function(){return Object.keys(this.columns)};e.prototype.getColumns=function(c,b){var a=this.aliases,d=this.columns,m={};c=c||Object.keys(d);for(var n=0,t=c.length,e,f;n<t;++n)f=c[n],(e=d[a[f]||f])&&(m[f]=b?e:e.slice());return m};e.prototype.getModifier=function(){return this.modifier};e.prototype.getRow=function(c,b){return this.getRows(c,1,b)[0]};e.prototype.getRowCount=
function(){return this.rowCount};e.prototype.getRowIndexBy=function(c,b,a){c=this.aliases[c]||c;if(c=this.columns[c])if(b=c.indexOf(b,a),-1!==b)return b};e.prototype.getRowObject=function(c,b){return this.getRowObjects(c,1,b)[0]};e.prototype.getRowObjects=function(c,b,a){void 0===c&&(c=0);void 0===b&&(b=this.rowCount-c);var d=this.aliases,m=this.columns,n=Array(b);a=a||Object.keys(m);var t=c,e=0;c=Math.min(this.rowCount,c+b);for(var f;t<c;++t,++e){f=n[e]={};for(var g=0,h=a;g<h.length;g++){var k=h[g];
b=m[d[k]||k];f[k]=b?b[t]:void 0}}return n};e.prototype.getRows=function(c,b,a){void 0===c&&(c=0);void 0===b&&(b=this.rowCount-c);var d=this.aliases,m=this.columns,n=Array(b);a=a||Object.keys(m);var e=c,f=0;c=Math.min(this.rowCount,c+b);for(var y;e<c;++e,++f){b=n[f]=[];for(var g=0,h=a;g<h.length;g++)y=h[g],y=m[d[y]||y],b.push(y?y[e]:void 0)}return n};e.prototype.getVersionTag=function(){return this.versionTag};e.prototype.hasColumns=function(c){for(var b=this.aliases,a=this.columns,d=0,m=c.length,
n;d<m;++d)if(n=c[d],!a[n]&&!b[n])return!1;return!0};e.prototype.hasRowWith=function(c,b){c=this.aliases[c]||c;return(c=this.columns[c])?-1!==c.indexOf(b):!1};e.prototype.on=function(c,b){return g(this,c,b)};e.prototype.renameColumn=function(c,b){var a=this.columns;if(a[c]){if(c!==b){var d=this.aliases;d[b]&&delete d[b];a[b]=a[c];delete a[c]}return!0}return!1};e.prototype.setCell=function(c,b,a,d){var m=this.columns,n=this.modifier;c=this.aliases[c]||c;var e=m[c];e&&e[b]===a||(this.emit({type:"setCell",
cellValue:a,columnName:c,detail:d,rowIndex:b}),e||(e=m[c]=Array(this.rowCount)),b>=this.rowCount&&(this.rowCount=b+1),e[b]=a,n&&n.modifyCell(this,c,b,a),this.emit({type:"afterSetCell",cellValue:a,columnName:c,detail:d,rowIndex:b}))};e.prototype.setColumn=function(c,b,a,d){var m;void 0===b&&(b=[]);void 0===a&&(a=0);this.setColumns((m={},m[c]=b,m),a,d)};e.prototype.setColumnAlias=function(c,b){var a=this.aliases;return a[c]?!1:(a[c]=b,!0)};e.prototype.setColumns=function(c,b,a){var d=this.columns,m=
this.modifier,n="undefined"===typeof b,e=Object.keys(c);this.emit({type:"setColumns",columns:c,columnNames:e,detail:a,rowIndex:b});for(var f=0,y=e.length,g,h;f<y;++f)if(h=e[f],g=c[h],h=this.aliases[h]||h,n)d[h]=g.slice(),this.rowCount=g.length;else{h=d[h]?d[h]:d[h]=Array(this.rowCount);for(var k=b||0,q=g.length;k<q;++k)h[k]=g[k];this.rowCount=Math.max(this.rowCount,h.length)}n=Object.keys(d);f=0;for(y=n.length;f<y;++f)d[n[f]].length=this.rowCount;m&&m.modifyColumns(this,c,b||0);this.emit({type:"afterSetColumns",
columns:c,columnNames:e,detail:a,rowIndex:b})};e.prototype.setModifier=function(c,b){var a=this;a.emit({type:"setModifier",detail:b,modifier:c,modified:a.modified});a.modified=a;a.modifier=c;return(c?c.modify(a):Promise.resolve(a)).then(function(a){a.emit({type:"afterSetModifier",detail:b,modifier:c,modified:a.modified});return a})["catch"](function(d){a.emit({type:"setModifierError",error:d,modifier:c,modified:a.modified});throw d;})};e.prototype.setRow=function(c,b,a){this.setRows([c],b,a)};e.prototype.setRows=
function(c,b,a){void 0===b&&(b=this.rowCount);var d=this.aliases,m=this.columns,n=Object.keys(m),t=this.modifier,f=c.length;this.emit({type:"setRows",detail:a,rowCount:f,rowIndex:b,rows:c});for(var h=0,g=b,u;h<f;++h,++g)if(u=c[h],u===e.NULL)for(var k=0,q=n.length;k<q;++k)m[n[k]][g]=null;else if(u instanceof Array)for(k=0,q=n.length;k<q;++k)m[n[k]][g]=u[k];else{var l=Object.keys(u);k=0;q=l.length;for(var w;k<q;++k)w=l[k],w=d[w]||w,m[w]||(m[w]=Array(g+1)),m[w][g]=u[w]}d=b+f;if(d>this.rowCount)for(this.rowCount=
d,h=0,g=n.length;h<g;++h)m[n[h]].length=d;t&&t.modifyRows(this,c,b);this.emit({type:"afterSetRows",detail:a,rowCount:f,rowIndex:b,rows:c})};e.NULL={};return e}();"";return k});p(l,"Data/Connectors/DataConnector.js",[l["Data/Modifiers/DataModifier.js"],l["Data/DataTable.js"],l["Core/Utilities.js"]],function(k,g,h){var f=h.addEvent,e=h.fireEvent,c=h.merge,b=h.pick;h=function(){function a(a){void 0===a&&(a={});this.table=new g(a.dataTable);this.metadata=a.metadata||{columns:{}}}Object.defineProperty(a.prototype,
"polling",{get:function(){return!!this.polling},enumerable:!1,configurable:!0});a.prototype.describeColumn=function(a,b){var d=this.metadata.columns;d[a]=c(d[a]||{},b)};a.prototype.describeColumns=function(a){for(var d=Object.keys(a),b;"string"===typeof(b=d.pop());)this.describeColumn(b,a[b])};a.prototype.emit=function(a){e(this,a.type,a)};a.prototype.getColumnOrder=function(){var a=this.metadata.columns,m=Object.keys(a||{});if(m.length)return m.sort(function(d,m){return b(a[d].index,0)-b(a[m].index,
0)})};a.prototype.getSortedColumns=function(a){return this.table.getColumns(this.getColumnOrder(a))};a.prototype.load=function(){e(this,"afterLoad",{table:this.table});return Promise.resolve(this)};a.prototype.on=function(a,b){return f(this,a,b)};a.prototype.save=function(){e(this,"saveError",{table:this.table});return Promise.reject(Error("Not implemented"))};a.prototype.setColumnOrder=function(a){for(var d=0,b=a.length;d<b;++d)this.describeColumn(a[d],{index:d})};a.prototype.setModifierOptions=
function(a){var d=this,b=a&&k.types[a.type];return this.table.setModifier(b?new b(a):void 0).then(function(){return d})};a.prototype.startPolling=function(a){void 0===a&&(a=1E3);var d=this;window.clearTimeout(d._polling);d._polling=window.setTimeout(function(){return d.load()["catch"](function(a){return d.emit({type:"loadError",error:a,table:d.table})}).then(function(){d._polling&&d.startPolling(a)})},a)};a.prototype.stopPolling=function(){window.clearTimeout(this._polling);delete this._polling};
a.prototype.whatIs=function(a){return this.metadata.columns[a]};return a}();(function(a){a.types={};a.registerType=function(d,b){return!!d&&!a.types[d]&&!!(a.types[d]=b)}})(h||(h={}));return h});p(l,"Data/Converters/DataConverter.js",[l["Data/DataTable.js"],l["Core/Utilities.js"]],function(k,g){var h=g.addEvent,f=g.fireEvent,e=g.isNumber,c=g.merge;g=function(){function b(a){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(a){return a?Date.UTC(+a[1],
a[3]-1,+a[4]):NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[3]-1,+a[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[1]-1,+a[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){if(!a)return NaN;var d=+a[4];d=d>(new Date).getFullYear()-2E3?d+1900:d+2E3;return Date.UTC(d,a[3]-1,
+a[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){return a?Date.UTC(+a[4]+2E3,a[1]-1,+a[3]):NaN}}};a=c(b.defaultOptions,a);var d=a.decimalPoint;if("."===d||","===d)this.decimalRegExp=new RegExp("^(-?[0-9]+)"+("."===d?"\\.":",")+"([0-9]+)$");this.options=a}b.prototype.asBoolean=function(a){return"boolean"===typeof a?a:"string"===typeof a?""!==a&&"0"!==a&&"false"!==a:!!this.asNumber(a)};b.prototype.asDate=function(a){if("string"===
typeof a)a=this.parseDate(a);else if("number"!==typeof a){if(a instanceof Date)return a;a=this.parseDate(this.asString(a))}return new Date(a)};b.prototype.asGuessedType=function(a){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(a)].call(this,a)};b.prototype.asNumber=function(a){if("number"===typeof a)return a;if("boolean"===typeof a)return a?1:0;if("string"===typeof a){var d=this.decimalRegExp;-1<a.indexOf(" ")&&(a=a.replace(/\s+/g,""));if(d){if(!d.test(a))return NaN;
a=a.replace(d,"$1.$2")}return parseFloat(a)}return a instanceof Date?a.getDate():a?a.getRowCount():NaN};b.prototype.asString=function(a){return""+a};b.prototype.deduceDateFormat=function(a,d,b){var c=[],m=[],e="YYYY/mm/dd",f=[],h=0,g=!1,k,q;if(!d||d>a.length)d=a.length;for(;h<d;h++)if("undefined"!==typeof a[h]&&a[h]&&a[h].length){var l=a[h].trim().replace(/[-\.\/]/g," ").split(" ");f=["","",""];for(q=0;q<l.length;q++)q<f.length&&(k=parseInt(l[q],10))&&(m[q]=!m[q]||m[q]<k?k:m[q],"undefined"!==typeof c[q]?
c[q]!==k&&(c[q]=!1):c[q]=k,31<k?f[q]=100>k?"YY":"YYYY":12<k&&31>=k?(f[q]="dd",g=!0):f[q].length||(f[q]="mm"))}if(g){for(q=0;q<c.length;q++)!1!==c[q]?12<m[q]&&"YY"!==f[q]&&"YYYY"!==f[q]&&(f[q]="YY"):12<m[q]&&"mm"===f[q]&&(f[q]="dd");3===f.length&&"dd"===f[1]&&"dd"===f[2]&&(f[2]="YY");e=f.join("/")}b&&(this.options.dateFormat=e);return e};b.prototype.emit=function(a){f(this,a.type,a)};b.prototype.export=function(){this.emit({type:"exportError",columns:[],headers:[]});throw Error("Not implemented");
};b.prototype.getTable=function(){throw Error("Not implemented");};b.prototype.guessType=function(a){var d="string";if("string"===typeof a){var b=this.trim("".concat(a)),c=this.decimalRegExp;b=this.trim(b,!0);c&&(b=c.test(b)?b.replace(c,"$1.$2"):"");c=parseFloat(b);+b===c?a=c:(d=this.parseDate(a),d=e(d)?"Date":"string")}"number"===typeof a&&(d=31536E6<a?"Date":"number");return d};b.prototype.on=function(a,d){return h(this,a,d)};b.prototype.parse=function(){this.emit({type:"parseError",columns:[],
headers:[]});throw Error("Not implemented");};b.prototype.parseDate=function(a,d){var b=this.options,c=d||b.dateFormat;d=NaN;var t,f;if(b.parseDate)d=b.parseDate(a);else{if(c)(b=this.dateFormats[c])||(b=this.dateFormats["YYYY/mm/dd"]),(f=a.match(b.regex))&&(d=b.parser(f));else for(t in this.dateFormats)if(b=this.dateFormats[t],f=a.match(b.regex)){d=b.parser(f);break}f||(f=Date.parse(a),"object"===typeof f&&null!==f&&f.getTime?d=f.getTime()-6E4*f.getTimezoneOffset():e(f)&&(d=f-6E4*(new Date(f)).getTimezoneOffset(),
-1===a.indexOf("2001")&&2001===(new Date(d)).getFullYear()&&(d=NaN)))}return d};b.prototype.trim=function(a,b){"string"===typeof a&&(a=a.replace(/^\s+|\s+$/g,""),b&&/^[0-9\s]+$/.test(a)&&(a=a.replace(/\s/g,"")));return a};b.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1};return b}();(function(b){b.getTableFromColumns=function(a,b){void 0===a&&(a=[]);void 0===b&&(b=[]);for(var d=
new k,c=0,e=Math.max(b.length,a.length);c<e;++c)d.setColumn(b[c]||"".concat(c),a[c]);return d}})(g||(g={}));return g});p(l,"Data/DataCursor.js",[],function(){var k=function(){function g(h){void 0===h&&(h={});this.emittingRegister=[];this.listenerMap={};this.stateMap=h}g.prototype.addListener=function(h,f,e){h=this.listenerMap[h]=this.listenerMap[h]||{};(h[f]=h[f]||[]).push(e);return this};g.prototype.buildEmittingTag=function(h){return("position"===h.cursor.type?[h.table.id,h.cursor.column,h.cursor.row,
h.cursor.state,h.cursor.type]:[h.table.id,h.cursor.columns,h.cursor.firstRow,h.cursor.lastRow,h.cursor.state,h.cursor.type]).join("\x00")};g.prototype.emitCursor=function(h,f,e,c,b){var a="object"===typeof f?f:e;e="object"===typeof c?c:e;var d="string"===typeof f?f:void 0,m=h.id;f=a.state;if(f=this.listenerMap[m]&&this.listenerMap[m][f]){m=this.stateMap[m]=this.stateMap[m]||{};var n=m[a.state]||[];if(b||!0===c)n.length||(m[a.state]=n),-1===g.getIndex(a,n)&&n.push(a);h={cursor:a,cursors:n,table:h};
e&&(h.event=e);d&&(h.group=d);b=this.emittingRegister;c=this.buildEmittingTag(h);if(0<=b.indexOf(c))return this;try{this.emittingRegister.push(c);b=0;for(var t=f.length;b<t;++b)f[b].call(this,h)}finally{t=this.emittingRegister.indexOf(c),0<=t&&this.emittingRegister.splice(t,1)}}return this};g.prototype.remitCursor=function(h,f){if(h=this.stateMap[h]&&this.stateMap[h][f.state])f=g.getIndex(f,h),0<=f&&h.splice(f,1);return this};g.prototype.removeListener=function(h,f,e){(h=this.listenerMap[h]&&this.listenerMap[h][f])&&
(e=h.indexOf(e))&&h.splice(e,1);return this};return g}();(function(g){function h(f,e){var c,b,a,d;if("range"===f.type)return f;e={type:"range",firstRow:null!==(b=null!==(c=f.row)&&void 0!==c?c:e&&e.firstRow)&&void 0!==b?b:0,lastRow:null!==(d=null!==(a=f.row)&&void 0!==a?a:e&&e.lastRow)&&void 0!==d?d:Number.MAX_VALUE,state:f.state};"undefined"!==typeof f.column&&(e.columns=[f.column]);return e}g.getIndex=function(f,e){if("position"===f.type)for(var c,b=0,a=e.length;b<a;++b){if(c=e[b],"position"===
c.type&&c.state===f.state&&c.column===f.column&&c.row===f.row)return b}else{var d=JSON.stringify(f.columns);b=0;for(a=e.length;b<a;++b)if(c=e[b],"range"===c.type&&c.state===f.state&&c.firstRow===f.firstRow&&c.lastRow===f.lastRow&&JSON.stringify(c.columns)===d)return b}return-1};g.isEqual=function(f,e){return"position"===f.type&&"position"===e.type?f.column===e.column&&f.row===e.row&&f.state===e.state:"range"===f.type&&"range"===e.type?f.firstRow===e.firstRow&&f.lastRow===e.lastRow&&JSON.stringify(f.columns)===
JSON.stringify(e.columns):!1};g.isInRange=function(f,e){"position"===e.type&&(e=h(e));"position"===f.type&&(f=h(f,e));var c=f.columns,b=e.columns;return f.firstRow>=e.firstRow&&f.lastRow<=e.lastRow&&(!c||!b||c.every(function(a){return 0<=b.indexOf(a)}))};g.toPositions=function(f){if("position"===f.type)return[f];var e=f.columns||[],c=[],b=f.state,a=f.firstRow;for(f=f.lastRow;a<f;++a)if(e.length)for(var d=0,m=e.length;d<m;++d)c.push({type:"position",column:e[d],row:a,state:b});else c.push({type:"position",
row:a,state:b});return c};g.toRange=h})(k||(k={}));"";return k});p(l,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}});p(l,"Data/DataPool.js",[l["Data/Connectors/DataConnector.js"],l["Data/DataPoolDefaults.js"],l["Core/Utilities.js"]],function(k,g,h){return function(){function f(e){void 0===e&&(e=g);e.connectors=e.connectors||[];this.connectors={};this.options=e;this.waiting={}}f.prototype.emit=function(e){h.fireEvent(this,e.type,e)};f.prototype.getConnector=function(e){var c=this,
b=this.connectors[e];if(b)return Promise.resolve(b);var a=this.waiting[e];if(a)return new Promise(function(b){a.push(b)});this.waiting[e]=a=[];if(b=this.getConnectorOptions(e))return this.loadConnector(b).then(function(b){delete c.waiting[e];window.setTimeout(function(){for(var d=0,c=a.length;d<c;++d)a[d](b)},1);return b});throw Error("Connector not found. (".concat(e,")"));};f.prototype.getConnectorIds=function(){for(var e=this.options.connectors,c=[],b=0,a=e.length;b<a;++b)c.push(e[b].id);return c};
f.prototype.getConnectorOptions=function(e){for(var c=this.options.connectors,b=0,a=c.length;b<a;++b)if(c[b].id===e)return c[b]};f.prototype.getConnectorTable=function(e){return this.getConnector(e).then(function(c){return c.table})};f.prototype.loadConnector=function(e){var c=this;return new Promise(function(b,a){c.emit({type:"load",options:e});var d=k.types[e.type];if(!d)throw Error("Connector type not found. (".concat(e.type,")"));(new d(e.options)).load().then(function(a){c.emit({type:"afterLoad",
options:e});c.connectors[e.id]=a;b(a)})["catch"](a)})};f.prototype.on=function(e,c){return h.addEvent(this,e,c)};f.prototype.setConnectorOptions=function(e){var c=this.options.connectors;this.emit({type:"setConnectorOptions",options:e});for(var b=0,a=c.length;b<a;++b)if(c[b].id===e.id){c.splice(b,1);break}c.push(e);this.emit({type:"afterSetConnectorOptions",options:e})};return f}()});p(l,"Data/Formula/FormulaParser.js",[],function(){function k(a){for(var b=0,d=0,c=a.length,m,n=1;d<c;++d)if(m=a[d],
"("===m)b||(n=d+1),++b;else if(")"===m&&(--b,!b))return a.substring(n,d);if(0<b)throw a=Error("Incomplete parantheses."),a.name="FormulaParseError",a;return""}function g(a){for(var b=-1,d=0,c=a.length,m,n=!1;d<c;++d)if(m=a[d],"\\"===m)n=!n;else if(n)n=!1;else if('"'===m)if(0>b)b=d;else return a.substring(b+1,d);a=Error("Incomplete string.");a.name="FormulaParseError";throw a;}function h(a,b){var d;if(d=a.match(D)){a=""===d[2]||"["===d[2][0];b=""===d[1]||"["===d[1][0];var m=""===d[4]||"["===d[4][0],
n=""===d[3]||"["===d[3][0];d={type:"range",beginColumn:a?parseInt(d[2].substring(1,-1)||"0",10):parseInt(d[2],10)-1,beginRow:b?parseInt(d[1].substring(1,-1)||"0",10):parseInt(d[1],10)-1,endColumn:m?parseInt(d[4].substring(1,-1)||"0",10):parseInt(d[4],10)-1,endRow:n?parseInt(d[3].substring(1,-1)||"0",10):parseInt(d[3],10)-1};a&&(d.beginColumnRelative=!0);b&&(d.beginRowRelative=!0);m&&(d.endColumnRelative=!0);n&&(d.endRowRelative=!0);return d}if(d=a.match(t))return a="$"!==d[1][0],b="$"!==d[2][0],m=
"$"!==d[3][0],n="$"!==d[4][0],d={type:"range",beginColumn:c(a?d[1]:d[1].substring(1))-1,beginRow:parseInt(b?d[2]:d[2].substring(1),10)-1,endColumn:c(m?d[3]:d[3].substring(1))-1,endRow:parseInt(n?d[4]:d[4].substring(1),10)-1},a&&(d.beginColumnRelative=!0),b&&(d.beginRowRelative=!0),m&&(d.endColumnRelative=!0),n&&(d.endRowRelative=!0),d;d=e(a,b);return 1===d.length&&"string"!==typeof d[0]?d[0]:d}function f(a,d){for(var b=[],c=d?";":",",m=0,n="",e=0,t=a.length,f;e<t;++e)(f=a[e],f===c&&!m&&n)?(b.push(h(n,
d)),n=""):'"'!==f||m||n?" "!==f&&(n+=f,"("===f?++m:")"===f&&--m):(f=g(a.substring(e)),b.push(f),e+=f.length+1);!m&&n&&b.push(h(n,d));return b}function e(t,h){for(var D=h?d:a,B=[],u,r=("="===t[0]?t.substring(1):t).trim();r;)if(u=r.match(l)){var x=""===u[2]||"["===u[2][0],p=""===u[1]||"["===u[1][0],C={type:"reference",column:x?parseInt(u[2].substring(1,-1)||"0",10):parseInt(u[2],10)-1,row:p?parseInt(u[1].substring(1,-1)||"0",10):parseInt(u[1],10)-1};x&&(C.columnRelative=!0);p&&(C.rowRelative=!0);B.push(C);
r=r.substring(u[0].length).trim()}else if(u=r.match(y))x="$"!==u[1][0],p="$"!==u[2][0],C={type:"reference",column:c(x?u[1]:u[1].substring(1))-1,row:parseInt(p?u[2]:u[2].substring(1),10)-1},x&&(C.columnRelative=!0),p&&(C.rowRelative=!0),B.push(C),r=r.substring(u[0].length).trim();else if(u=r.match(n))B.push(u[0]),r=r.substring(u[0].length).trim();else if(u=r.match(b))B.push("TRUE"===u[0]),r=r.substring(u[0].length).trim();else if(u=r.match(D))B.push(parseFloat(u[0])),r=r.substring(u[0].length).trim();
else if('"'===r[0])u=g(r),B.push(u.substring(1,-1)),r=r.substring(u.length+2).trim();else if(u=r.match(m))r=r.substring(u[1].length).trim(),x=k(r),B.push({type:"function",name:u[1],args:f(x,h)}),r=r.substring(x.length+2).trim();else{if("("===r[0]&&(u=k(r))){B.push(e(u,h));r=r.substring(u.length+2).trim();continue}h=t.length-r.length;t=Error("Unexpected character `"+t.substring(h,h+1)+"` at position "+(h+1)+". (`..."+t.substring(h-5,h+6)+"...`)");t.name="FormulaParseError";throw t;}return B}function c(a){for(var d=
0,b=0,c=a.length,m,n=a.length-1;b<c;++b)m=a.charCodeAt(b),65<=m&&90>=m&&(d+=(m-64)*Math.pow(26,n)),--n;return d}var b=/^(?:FALSE|TRUE)/,a=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,d=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,m=/^([A-Z][A-Z\d\.]*)\(/,n=/^(?:[+\-*\/^<=>]|<=|=>)/,t=/^(\$?[A-Z]+)(\$?\d+):(\$?[A-Z]+)(\$?\d+)/,D=/^R(\d*|\[\d+\])C(\d*|\[\d+\]):R(\d*|\[\d+\])C(\d*|\[\d+\])/,y=/^(\$?[A-Z]+)(\$?\d+)(?![:C])/,l=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!:)/;return{parseFormula:e}});p(l,"Data/Formula/FormulaTypes.js",
[],function(){var k="+ - * / ^ = < <= > >=".split(" ");return{isFormula:function(g){return g instanceof Array},isFunction:function(g){return"object"===typeof g&&!(g instanceof Array)&&"function"===g.type},isOperator:function(g){return"string"===typeof g&&0<=k.indexOf(g)},isRange:function(g){return"object"===typeof g&&!(g instanceof Array)&&"range"===g.type},isReference:function(g){return"object"===typeof g&&!(g instanceof Array)&&"reference"===g.type},isValue:function(g){return"boolean"===typeof g||
"number"===typeof g||"string"===typeof g}}});p(l,"Data/Formula/FormulaProcessor.js",[l["Data/Formula/FormulaTypes.js"]],function(k){function g(a){switch(typeof a){case "boolean":return a?r:z;case "string":return p;case "number":return a;default:return NaN}}function h(a){return"string"===typeof a?a.toLowerCase().replace(q,"\x00"):a}function f(a){switch(typeof a){case "boolean":return a?1:0;case "string":return parseFloat(a.replace(",","."));case "number":return a;default:return NaN}}function e(a,d,
b){switch(a){case "=":return h(d)===h(b);case "<":return typeof d===typeof b?h(d)<h(b):g(d)<g(b);case "<=":return typeof d===typeof b?h(d)<=h(b):g(d)<=g(b);case ">":return typeof d===typeof b?h(d)>h(b):g(d)>g(b);case ">=":return typeof d===typeof b?h(d)>=h(b):g(d)>=g(b)}d=f(d);b=f(b);switch(a){case "+":a=d+b;break;case "-":a=d-b;break;case "*":a=d*b;break;case "/":a=d/b;break;case "^":a=Math.pow(d,b);break;default:return NaN}return a%1?Math.round(1E9*a)/1E9:a}function c(a,c){return x(a)?a:l(a)?c&&
b(a,c)||[]:D(a)?m(a,c):d(t(a)?a:[a],c)}function b(a,d){for(var b=d.getColumnNames().slice(a.beginColumn,a.endColumn+1),c=[],m=0,n=b.length,e;m<n;++m)for(var t=d.getColumn(b[m],!0)||[],f=a.beginRow,h=a.endRow+1;f<h;++f)e=t[f],"string"===typeof e&&"="===e[0]&&d!==d.modified&&(e=d.modified.getCell(b[m],f)),c.push(x(e)?e:NaN);return c}function a(a,d){var b=d.getColumnNames()[a.column];if(b){var c=d.getCell(b,a.row);return"string"===typeof c&&"="===c[0]&&d!==d.modified?(a=d.modified.getCell(b,a.row),x(a)?
a:NaN):x(c)?c:NaN}return NaN}function d(b,c){var n=0,f=b.length,h=void 0,g;for(g=void 0;n<f;++n){var k=b[n];if(y(k))h=k;else if(x(k)?g=k:t(k)?g=d(b,c):D(k)?(g=m(k,c),g=x(g)?g:NaN):u(k)&&(g=c&&a(k,c)),"undefined"!==typeof g){if("undefined"===typeof l)var l=h?e(h,0,g):g;else if(h)k=b[n+1],y(k)&&v[k]>v[h]&&(g=e(k,g,d(b.slice(n+2))),n=f),l=e(h,l,g);else return NaN;g=h=void 0}}return x(l)?l:NaN}function m(a,d){var b=A[a.name];if(b)try{return b(a.args,d)}catch(E){return NaN}a=Error('Function "'.concat(a.name,
'" not found.'));a.name="FormulaProcessError";throw a;}function n(a,d,b){void 0===d&&(d=0);void 0===b&&(b=0);for(var c=0,m=a.length,e;c<m;++c)e=a[c],e instanceof Array?n(e):D(e)?n(e.args):l(e)?(e.beginColumnRelative&&(e.beginColumn+=d),e.beginRowRelative&&(e.beginRow+=b),e.endColumnRelative&&(e.endColumn+=d),e.endRowRelative&&(e.endRow+=b)):u(e)&&(e.columnRelative&&(e.column+=d),e.rowRelative&&(e.row+=b));return a}var t=k.isFormula,D=k.isFunction,y=k.isOperator,l=k.isRange,u=k.isReference,x=k.isValue,
q=/ */,z=Number.MAX_VALUE/1.000000000001,p=Number.MAX_VALUE/1.000000000002,r=Number.MAX_VALUE,v={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},A={},C=/^[A-Z][A-Z\.]*$/;return{asNumber:f,getArgumentValue:c,getArgumentsValues:function(a,d){for(var b=[],m=0,n=a.length;m<n;++m)b.push(c(a[m],d));return b},getRangeValues:b,getReferenceValue:a,processFormula:d,processorFunctions:A,registerProcessorFunction:function(a,d){return C.test(a)&&!A[a]&&!!(A[a]=d)},translateReferences:n}});p(l,"Data/Formula/Functions/ABS.js",
[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){f=h(f[0],e);switch(typeof f){case "number":return Math.abs(f);case "object":e=[];for(var c=0,b=f.length,a;c<b;++c){a=f[c];if("number"!==typeof a)return NaN;e.push(Math.abs(a))}return e;default:return NaN}}var h=k.getArgumentValue;k.registerProcessorFunction("ABS",g);return g});p(l,"Data/Formula/Functions/AND.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){for(var c=0,b=f.length,a;c<b;++c)if(a=h(f[c],e),!a||
"object"===typeof a&&!g(a,e))return!1;return!0}var h=k.getArgumentValue;k.registerProcessorFunction("AND",g);return g});p(l,"Data/Formula/Functions/AVERAGE.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){f=h(f,e);for(var c=e=0,b=0,a=f.length,d;b<a;++b)switch(d=f[b],typeof d){case "number":isNaN(d)||(++e,c+=d);break;case "object":for(var m=0,n=d.length,t;m<n;++m)t=d[m],"number"!==typeof t||isNaN(t)||(++e,c+=t)}return e?c/e:0}var h=k.getArgumentsValues;k.registerProcessorFunction("AVERAGE",
g);return g});p(l,"Data/Formula/Functions/AVERAGEA.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){for(var c=0,b=0,a=0,d=f.length,m;a<d;++a)switch(m=h(f[a],e),typeof m){case "boolean":++c;b+=m?1:0;continue;case "number":isNaN(m)||(++c,b+=m);continue;case "string":++c;continue;default:for(var n=0,t=m.length,g;n<t;++n)switch(g=m[n],typeof g){case "boolean":++c;b+=g?1:0;continue;case "number":isNaN(g)||(++c,b+=g);continue;case "string":++c}}return c?b/c:0}var h=k.getArgumentValue;
k.registerProcessorFunction("AVERAGEA",g);return g});p(l,"Data/Formula/Functions/COUNT.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(h,f){h=k.getArgumentsValues(h,f);for(var e=0,c=0,b=h.length,a;c<b;++c)switch(a=h[c],typeof a){case "number":isNaN(a)||++e;break;case "object":e+=g(a,f)}return e}k.registerProcessorFunction("COUNT",g);return g});p(l,"Data/Formula/Functions/COUNTA.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(h,f){h=k.getArgumentsValues(h,f);for(var e=
0,c=0,b=h.length,a;c<b;++c){a=h[c];switch(typeof a){case "number":if(isNaN(a))continue;break;case "object":e+=g(a,f);continue;case "string":if(!a)continue}++e}return e}k.registerProcessorFunction("COUNTA",g);return g});p(l,"Data/Formula/Functions/IF.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){return h(f[0],e)?h(f[1],e):h(f[2],e)}var h=k.getArgumentValue;k.registerProcessorFunction("IF",g);return g});p(l,"Data/Formula/Functions/ISNA.js",[l["Data/Formula/FormulaProcessor.js"]],
function(k){function g(f,e){f=h(f[0],e);return"number"!==typeof f||isNaN(f)}var h=k.getArgumentValue;k.registerProcessorFunction("ISNA",g);return g});p(l,"Data/Formula/Functions/MAX.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){f=h(f,e);e=Number.NEGATIVE_INFINITY;for(var c=0,b=f.length,a;c<b;++c)switch(a=f[c],typeof a){case "number":a>e&&(e=a);break;case "object":a=g(a),a>e&&(e=a)}return isFinite(e)?e:0}var h=k.getArgumentsValues;k.registerProcessorFunction("MAX",g);return g});
p(l,"Data/Formula/Functions/MEDIAN.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(h,f){var e=[];h=k.getArgumentsValues(h,f);f=0;for(var c=h.length,b;f<c;++f)switch(b=h[f],typeof b){case "number":isNaN(b)||e.push(b);break;case "object":for(var a=0,d=b.length,m;a<d;++a)m=b[a],"number"!==typeof m||isNaN(m)||e.push(m)}h=e.length;if(!h)return NaN;f=Math.floor(h/2);return h%2?e[f]:(e[f-1]+e[f])/2}k.registerProcessorFunction("MEDIAN",g);return g});p(l,"Data/Formula/Functions/MIN.js",
[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){f=h(f,e);e=Number.POSITIVE_INFINITY;for(var c=0,b=f.length,a;c<b;++c)switch(a=f[c],typeof a){case "number":a<e&&(e=a);break;case "object":a=g(a),a<e&&(e=a)}return isFinite(e)?e:0}var h=k.getArgumentsValues;k.registerProcessorFunction("MIN",g);return g});p(l,"Data/Formula/Functions/MOD.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){var c=h(f[0],e);f=h(f[1],e);"object"===typeof c&&(c=c[0]);"object"===typeof f&&
(f=f[0]);return"number"!==typeof c||"number"!==typeof f||0===f?NaN:c%f}var h=k.getArgumentValue;k.registerProcessorFunction("MOD",g);return g});p(l,"Data/Formula/Functions/MODE.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(e,c){var b={};e=k.getArgumentsValues(e,c);c=0;for(var a=e.length,d;c<a;++c)switch(d=e[c],typeof d){case "number":isNaN(d)||(b[d]=(b[d]||0)+1);break;case "object":for(var m=0,n=d.length,t;m<n;++m)t=d[m],"number"!==typeof t||isNaN(t)||(b[t]=(b[t]||0)+1)}return b}
function h(e,c){e=g(e,c);c=Object.keys(e);if(!c.length)return NaN;for(var b=[parseFloat(c[0])],a=e[c[0]],d=1,m=c.length,n,t;d<m;++d)n=c[d],t=e[n],a<t?(b=[parseFloat(n)],a=t):a===t&&b.push(parseFloat(n));return 1<a?b:NaN}function f(e,c){e=g(e,c);c=Object.keys(e);if(!c.length)return NaN;for(var b=parseFloat(c[0]),a=e[c[0]],d=1,m=c.length,n,t;d<m;++d)n=c[d],t=e[n],a<t?(b=parseFloat(n),a=t):a===t&&(n=parseFloat(n),b>n&&(b=n,a=t));return 1<a?b:NaN}k.registerProcessorFunction("MODE",f);k.registerProcessorFunction("MODE.MULT",
h);k.registerProcessorFunction("MODE.SNGL",f);return{MULT:h,SNGL:f}});p(l,"Data/Formula/Functions/NOT.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){f=h(f[0],e);"object"===typeof f&&(f=f[0]);switch(typeof f){case "boolean":case "number":return!f}return NaN}var h=k.getArgumentValue;k.registerProcessorFunction("NOT",g);return g});p(l,"Data/Formula/Functions/OR.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){for(var c=0,b=f.length,a;c<b;++c)if(a=h(f[c],
e),"object"===typeof a){if(g(a,e))return!0}else if(a)return!0;return!1}var h=k.getArgumentValue;k.registerProcessorFunction("OR",g);return g});p(l,"Data/Formula/Functions/PRODUCT.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){f=h(f,e);for(var c=1,b=!1,a=0,d=f.length,m;a<d;++a)switch(m=f[a],typeof m){case "number":isNaN(m)||(b=!0,c*=m);break;case "object":b=!0,c*=g(m,e)}return b?c:0}var h=k.getArgumentsValues;k.registerProcessorFunction("PRODUCT",g);return g});p(l,"Data/Formula/Functions/SUM.js",
[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(h,f){h=k.getArgumentsValues(h,f);for(var e=0,c=0,b=h.length,a;c<b;++c)switch(a=h[c],typeof a){case "number":isNaN(a)||(e+=a);break;case "object":e+=g(a,f)}return e}k.registerProcessorFunction("SUM",g);return g});p(l,"Data/Formula/Functions/XOR.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function g(f,e){for(var c=0,b=f.length,a=void 0,d;c<b;++c)switch(d=h(f[c],e),typeof d){case "boolean":case "number":if("undefined"===typeof a)a=
!!d;else if(!!d!==a)return!0;break;case "object":for(var m=0,n=d.length,t;m<n;++m)switch(t=d[m],typeof t){case "boolean":case "number":if("undefined"===typeof a)a=!!t;else if(!!t!==a)return!0}}return!1}var h=k.getArgumentValue;k.registerProcessorFunction("XOR",g);return g});p(l,"Data/Formula/Formula.js",[l["Data/Formula/FormulaParser.js"],l["Data/Formula/FormulaProcessor.js"],l["Data/Formula/FormulaTypes.js"]],function(k,g,h){var f=this&&this.__assign||function(){f=Object.assign||function(e){for(var c,
b=1,a=arguments.length;b<a;b++){c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(e[d]=c[d])}return e};return f.apply(this,arguments)};return f(f(f({},k),g),h)});p(l,"Data/Converters/CSVConverter.js",[l["Data/Converters/DataConverter.js"],l["Core/Utilities.js"]],function(k,g){var h=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,
d)&&(a[d]=b[d])};return c(b,a)}return function(b,a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),f=this&&this.__assign||function(){f=Object.assign||function(c){for(var b,a=1,d=arguments.length;a<d;a++){b=arguments[a];for(var m in b)Object.prototype.hasOwnProperty.call(b,m)&&(c[m]=b[m])}return c};return f.apply(this,
arguments)},e=g.merge;return function(c){function b(a){var d=e(b.defaultOptions,a);a=c.call(this,d)||this;a.columns=[];a.headers=[];a.dataTypes=[];a.options=d;return a}h(b,c);b.prototype.export=function(a,d){void 0===d&&(d=this.options);var b=d.useLocalDecimalPoint,c=d.lineDelimiter,e=!1!==this.options.firstRowAsNames,f=d.decimalPoint,h=d.itemDelimiter;f||(f=","!==h&&b?(1.1).toLocaleString()[1]:".");h||(h=","===f?";":",");d=a.getSortedColumns(d.usePresentationOrder);b=Object.keys(d);var g=[],k=b.length,
l=[];e&&g.push(b.map(function(a){return'"'.concat(a,'"')}).join(h));for(e=0;e<k;e++){var q=b[e],z=d[q],p=z.length,r=a.whatIs(q);q=void 0;r&&(q=r.dataType);for(r=0;r<p;r++){var v=z[r];l[r]||(l[r]=[]);"string"===q?v='"'+v+'"':"number"===typeof v?v=String(v).replace(".",f):"string"===typeof v&&(v='"'.concat(v,'"'));l[r][e]=v;if(e===k-1){for(v=e;2<l[r].length&&void 0===l[r][v];)l[r].pop(),v--;g.push(l[r].join(h))}}}return g.join(c)};b.prototype.parse=function(a,d){var b=this.dataTypes,c=e(this.options,
a),f=c.beforeParse,h=c.lineDelimiter,g=c.firstRowAsNames,k=c.itemDelimiter,l=c.csv;a=c.startRow;c=c.endRow;this.columns=[];this.emit({type:"parse",columns:this.columns,detail:d,headers:this.headers});l&&f&&(l=f(l));if(l){f=l.replace(/\r\n|\r/g,"\n").split(h||"\n");if(!a||0>a)a=0;if(!c||c>=f.length)c=f.length-1;k||(this.guessedItemDelimiter=this.guessDelimiter(f));if(g){k=f[0].split(k||this.guessedItemDelimiter||",");for(g=0;g<k.length;g++)k[g]=k[g].trim().replace(/^["']|["']$/g,"");this.headers=k;
a++}k=0;for(g=a;g<=c;g++)"#"===f[g][0]?k++:this.parseCSVRow(f[g],g-a-k);b.length&&b[0].length&&"date"===b[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);g=0;for(a=this.columns.length;g<a;++g)for(b=this.columns[g],c=0,k=b.length;c<k;++c)b[c]&&"string"===typeof b[c]&&(f=this.asGuessedType(b[c]),f instanceof Date&&(f=f.getTime()),this.columns[g][c]=f)}this.emit({type:"afterParse",columns:this.columns,detail:d,headers:this.headers})};b.prototype.parseCSVRow=function(a,
b){function d(){if(k>v||v>l)++v,r="";else{"string"===typeof r?!isNaN(parseFloat(r))&&isFinite(r)?(r=parseFloat(r),c("number")):isNaN(Date.parse(r))?c("string"):(r=r.replace(/\//g,"-"),c("date")):c("number");f.length<A+1&&f.push([]);if("number"!==typeof r&&"number"!==e.guessType(r)&&q){var a=r;r=r.replace(q,".");"number"!==e.guessType(r)&&(r=a)}f[A][b]=r;r="";++A;++v}}function c(a){g.length<A+1&&g.push([a]);g[A][g[A].length-1]!==a&&g[A].push(a)}var e=this,f=e.columns||[],g=e.dataTypes,h=e.options,
k=h.startColumn,l=h.endColumn;h=e.options.itemDelimiter||e.guessedItemDelimiter;var q=e.options.decimalPoint;q&&q!==h||(q=e.guessedDecimalPoint||".");var p=0,w="",r="",v=0,A=0;if(a.trim().length&&"#"!==a.trim()[0]){for(;p<a.length;p++){w=a[p];if("#"===w&&!/^#[0-F]{3,3}|[0-F]{6,6}/i.test(a.substring(p))){d();return}if('"'===w)for(w=a[++p];p<a.length&&'"'!==w;)r+=w,w=a[++p];else w===h?d():r+=w}d()}};b.prototype.guessDelimiter=function(a){for(var b=0,c=0,e={",":0,";":0,"\t":0},f=a.length,g=0;g<f;g++){var h=
!1,k="";if(13<g)break;for(var l=a[g],p=0;p<l.length;p++){var q=l[p];var z=l[p+1];var w=l[p-1];if("#"===q)break;if('"'===q)if(h){if('"'!==w&&'"'!==z){for(;" "===z&&p<l.length;)z=l[++p];"undefined"!==typeof e[z]&&e[z]++;h=!1}}else h=!0;else"undefined"!==typeof e[q]?(k=k.trim(),isNaN(Date.parse(k))?!isNaN(Number(k))&&isFinite(Number(k))||e[q]++:e[q]++,k=""):k+=q;","===q&&c++;"."===q&&b++}}a=e[";"]>e[","]?";":",";this.guessedDecimalPoint=b>c?".":",";return a};b.prototype.getTable=function(){return k.getTableFromColumns(this.columns,
this.headers)};b.defaultOptions=f(f({},k.defaultOptions),{lineDelimiter:"\n"});return b}(k)});p(l,"Data/Connectors/CSVConnector.js",[l["Data/Converters/CSVConverter.js"],l["Data/Connectors/DataConnector.js"],l["Core/Utilities.js"]],function(k,g,h){var f=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return c(b,a)}return function(b,
a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),e=h.merge;h=function(c){function b(a){var d=e(b.defaultOptions,a);a=c.call(this,d)||this;a.converter=new k(d);a.options=d;d.enablePolling&&a.startPolling(1E3*Math.max(d.dataRefreshRate||0,1));return a}f(b,c);b.prototype.load=function(a){var b=this,c=b.converter,e=
b.table,f=b.options,g=f.csv,h=f.csvURL,k=f.dataModifier;b.emit({type:"load",csv:g,detail:a,table:e});e.deleteRows();return Promise.resolve(g?g:h?fetch(h||"").then(function(a){return a.text()}):"").then(function(a){a&&(c.parse({csv:a}),e.setColumns(c.getTable().getColumns()));return b.setModifierOptions(k).then(function(){return a})}).then(function(d){b.emit({type:"afterLoad",csv:d,detail:a,table:e});return b})["catch"](function(d){b.emit({type:"loadError",detail:a,error:d,table:e});throw d;})};b.defaultOptions=
{csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0};return b}(g);g.registerType("CSV",h);return h});p(l,"Data/Converters/JSONConverter.js",[l["Data/Converters/DataConverter.js"],l["Data/DataTable.js"],l["Core/Utilities.js"]],function(k,g,h){var f=this&&this.__extends||function(){function a(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return a(b,c)}
return function(b,c){function d(){this.constructor=b}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||function(){e=Object.assign||function(a){for(var b,c=1,e=arguments.length;c<e;c++){b=arguments[c];for(var f in b)Object.prototype.hasOwnProperty.call(b,f)&&(a[f]=b[f])}return a};return e.apply(this,arguments)},c=h.merge,b=h.isArray;
return function(a){function d(b){var e=c(d.defaultOptions,b);b=a.call(this,e)||this;b.columns=[];b.headers=[];b.dataTypes=[];b.options=e;b.table=new g;return b}f(d,a);d.prototype.parse=function(a){a=c(this.options,a);var d=a.beforeParse,e=a.orientation,m=a.firstRowAsNames,f=a.columnNames;if(a=a.data)if(d&&(a=d(a)),a=a.slice(),"columns"===e)for(e=0,d=a.length;e<d;e++){var g=a[e];if(!(g instanceof Array))break;m?this.headers.push("".concat(g.shift())):f&&this.headers.push(f[e]);this.table.setColumn(this.headers[e]||
e.toString(),g)}else if("rows"===e)for(m?this.headers=a.shift():f&&(this.headers=f),m=0,d=a.length;m<d;m++)if(f=a[m],b(f))for(e=0,g=f.length;e<g;e++)this.columns.length<e+1&&this.columns.push([]),this.columns[e].push(f[e]),this.table.setCell(this.headers[e]||m.toString(),m,f[e]);else this.table.setRows([f],m)};d.prototype.getTable=function(){return this.table};d.defaultOptions=e(e({},k.defaultOptions),{data:[],orientation:"columns"});return d}(k)});p(l,"Data/Connectors/JSONConnector.js",[l["Data/Connectors/DataConnector.js"],
l["Core/Utilities.js"],l["Data/Converters/JSONConverter.js"]],function(k,g,h){var f=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return c(b,a)}return function(b,a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=
null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),e=g.merge;g=function(c){function b(a){var d=e(b.defaultOptions,a);a=c.call(this,d)||this;a.converter=new h(d);a.options=d;d.enablePolling&&a.startPolling(1E3*Math.max(d.dataRefreshRate||0,1));return a}f(b,c);b.prototype.load=function(a){var b=this,c=b.converter,e=b.table,f=b.options,g=f.data,h=f.dataUrl,k=f.dataModifier;b.emit({type:"load",data:g,detail:a,table:e});e.deleteRows();return Promise.resolve(h?fetch(h).then(function(a){return a.json()}):
g?g:[]).then(function(a){a&&(c.parse({data:a}),e.setColumns(c.getTable().getColumns()));return b.setModifierOptions(k).then(function(){return a})}).then(function(d){b.emit({type:"afterLoad",data:d,detail:a,table:e});return b})["catch"](function(d){b.emit({type:"loadError",detail:a,error:d,table:e});throw d;})};b.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"};return b}(k);k.registerType("JSON",g);return g});p(l,"Data/Converters/GoogleSheetsConverter.js",
[l["Data/Converters/DataConverter.js"],l["Core/Utilities.js"]],function(k,g){var h=this&&this.__extends||function(){function b(a,d){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return b(a,d)}return function(a,d){function c(){this.constructor=a}if("function"!==typeof d&&null!==d)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");b(a,d);a.prototype=
null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),f=this&&this.__assign||function(){f=Object.assign||function(b){for(var a,d=1,c=arguments.length;d<c;d++){a=arguments[d];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e])}return b};return f.apply(this,arguments)},e=g.merge,c=g.uniqueKey;return function(b){function a(d){var c=e(a.defaultOptions,d);d=b.call(this,c)||this;d.columns=[];d.header=[];d.options=c;return d}h(a,b);a.prototype.parse=function(a,b){a=e(this.options,
a);var d=(a.json&&a.json.values||[]).map(function(a){return a.slice()});if(0===d.length)return!1;this.header=[];this.columns=[];this.emit({type:"parse",columns:this.columns,detail:b,headers:this.header});this.columns=d;for(var f,m=0,g=d.length;m<g;m++){f=d[m];this.header[m]=a.firstRowAsNames?"".concat(f.shift()):c();for(var h=0,k=f.length;h<k;++h)if(f[h]&&"string"===typeof f[h]){var l=this.asGuessedType(f[h]);l instanceof Date&&(l=l.getTime());this.columns[m][h]=l}}this.emit({type:"afterParse",columns:this.columns,
detail:b,headers:this.header})};a.prototype.getTable=function(){return k.getTableFromColumns(this.columns,this.header)};a.defaultOptions=f({},k.defaultOptions);return a}(k)});p(l,"Data/Connectors/GoogleSheetsConnector.js",[l["Data/Connectors/DataConnector.js"],l["Data/Converters/GoogleSheetsConverter.js"],l["Core/Utilities.js"]],function(k,g,h){var f=this&&this.__extends||function(){function b(a,d){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,
d)&&(a[d]=b[d])};return b(a,d)}return function(a,d){function c(){this.constructor=a}if("function"!==typeof d&&null!==d)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");b(a,d);a.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),e=h.merge,c=h.pick;h=function(b){function a(d){var c=e(a.defaultOptions,d);d=b.call(this,c)||this;d.converter=new g(c);d.options=c;return d}f(a,b);a.prototype.load=function(b){var d=this,c=d.converter,e=d.table,f=d.options,
g=f.dataModifier,h=f.dataRefreshRate,k=f.enablePolling,l=f.firstRowAsNames,q=a.buildFetchURL(f.googleAPIKey,f.googleSpreadsheetKey,d.options);d.emit({type:"load",detail:b,table:e,url:q});e.deleteColumns();return fetch(q).then(function(a){return a.json()}).then(function(a){if("object"===typeof a&&a&&"object"===typeof a.error&&a.error&&"number"===typeof a.error.code&&"string"===typeof a.error.message&&"string"===typeof a.error.status)throw Error(a.error.message);c.parse({firstRowAsNames:l,json:a});
e.setColumns(c.getTable().getColumns());return d.setModifierOptions(g)}).then(function(){d.emit({type:"afterLoad",detail:b,table:e,url:q});k&&setTimeout(function(){return d.load()},1E3*Math.max(h||0,1));return d})["catch"](function(a){d.emit({type:"loadError",detail:b,error:a,table:e});throw a;})};a.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};return a}(k);(function(b){function a(a){void 0===a&&(a={});var b=a.endColumn,
d=a.endRow,e=a.startColumn,f=a.startRow;return a.googleSpreadsheetRange||("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e||0]||"A")+(Math.max(f||0,0)+1)+":"+("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[c(b,25)]||"Z")+(d?Math.max(d,0):"Z")}b.buildFetchURL=function(b,c,e){void 0===e&&(e={});return"https://sheets.googleapis.com/v4/spreadsheets/".concat(c,"/values/")+(e.onlyColumnNames?"A1:Z1":a(e))+"?alt=json"+(e.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+
"&prettyPrint=false"+"&key=".concat(b)};b.buildQueryRange=a})(h||(h={}));k.registerType("GoogleSheets",h);return h});p(l,"Data/Converters/HTMLTableConverter.js",[l["Data/Converters/DataConverter.js"],l["Core/Utilities.js"]],function(k,g){var h=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return c(b,a)}return function(b,a){function d(){this.constructor=
b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),f=this&&this.__assign||function(){f=Object.assign||function(c){for(var b,a=1,d=arguments.length;a<d;a++){b=arguments[a];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(c[e]=b[e])}return c};return f.apply(this,arguments)},e=g.merge;return function(c){function b(a){var d=e(b.defaultOptions,
a);a=c.call(this,d)||this;a.columns=[];a.headers=[];a.options=d;d.tableElement&&(a.tableElement=d.tableElement,a.tableElementID=d.tableElement.id);return a}h(b,c);b.prototype.export=function(a,b){void 0===b&&(b=this.options);var d=!1!==b.firstRowAsNames,c=b.useMultiLevelHeaders,e=a.getSortedColumns(b.usePresentationOrder),f=Object.keys(e);a=[];var g=f.length,h=[],k="";if(d)if(k=[],c){for(c=0;c<f.length;c++)d=(e[f[c]].shift()||"").toString(),k.push(d);k=this.getTableHeaderHTML(f,k,b)}else k=this.getTableHeaderHTML(void 0,
f,b);for(c=0;c<g;c++){d=e[f[c]];for(var l=d.length,q=0;q<l;q++){var p=d[q];h[q]||(h[q]=[]);"string"!==typeof p&&"number"!==typeof p&&"undefined"!==typeof p&&(p=(p||"").toString());h[q][c]=this.getCellHTMLFromValue(c?"td":"th",null,c?"":'scope="row"',p);c===g-1&&a.push("<tr>"+h[q].join("")+"</tr>")}}e="";b.tableCaption&&(e='<caption class="highcharts-table-caption">'+b.tableCaption+"</caption>");return"<table>"+e+k+"<tbody>"+a.join("")+"</tbody></table>"};b.prototype.getCellHTMLFromValue=function(a,
b,c,e,f){var d=e;b="text"+(b?" "+b:"");"number"===typeof d?(d=d.toString(),","===f&&(d=d.replace(".",f)),b="number"):e||(d="",b="empty");return"<"+a+(c?" "+c:"")+' class="'+b+'">'+d+"</"+a+">"};b.prototype.getTableHeaderHTML=function(a,b,c){void 0===a&&(a=[]);void 0===b&&(b=[]);void 0===c&&(c=this.options);var d=c.useMultiLevelHeaders,e=c.useRowspanHeaders;c.useLocalDecimalPoint&&(1.1).toLocaleString();c="<thead>";var f=0,m=b&&b.length,g=0;if(d=d&&a&&b){a:if(d=a.length,b.length===d){for(;--d;)if(a[d]!==
b[d]){d=!1;break a}d=!0}else d=!1;d=!d}if(d){for(c+="<tr>";f<m;++f){d=a[f];var h=a[f+1];d===h?++g:g?(c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(g+1)+'"',d),g=0):(d===b[f]?e?(h=2,delete b[f]):(h=1,b[f]=""):h=1,c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<h?' valign="top" rowspan="'+h+'"':""),d))}c+="</tr>"}if(b){c+="<tr>";f=0;for(m=b.length;f<m;++f)"undefined"!==typeof b[f]&&(c+=this.getCellHTMLFromValue("th",null,'scope="col"',
b[f]));c+="</tr>"}return c+"</thead>"};b.prototype.parse=function(a,b){var d=[],c=[],f=e(this.options,a);a=f.endRow;var g=f.startColumn,h=f.endColumn,k=f.firstRowAsNames,l=f.tableElement||this.tableElement;if(l instanceof HTMLElement){this.tableElement=l;this.tableElementID=l.id;this.emit({type:"parse",columns:this.columns,detail:b,headers:this.headers});l=l.getElementsByTagName("tr");var p=l.length,q=0;f=f.startRow;if(k&&p){for(var z=l[0].children,w=z.length,r=g;r<w&&!(r>h);r++)k=z[r],"TD"!==k.tagName&&
"TH"!==k.tagName||c.push(k.innerHTML);f++}for(;q<p;){if(q>=f&&q<=a){z=l[q].children;w=z.length;for(var v=0;v<w;){r=v-g;var A=d[r];k=z[v];if(("TD"===k.tagName||"TH"===k.tagName)&&v>=g&&v<=h)for(d[r]||(d[r]=[]),k=this.asGuessedType(k.innerHTML),k instanceof Date&&(k=k.getTime()),d[r][q-f]=k,r=1;q-f>=r&&void 0===A[q-f-r];)A[q-f-r]=null,r++;v++}}q++}this.columns=d;this.headers=c;this.emit({type:"afterParse",columns:d,detail:b,headers:c})}else this.emit({type:"parseError",columns:d,detail:b,headers:c,
error:"Not a valid HTML Table"})};b.prototype.getTable=function(){return k.getTableFromColumns(this.columns,this.headers)};b.defaultOptions=f(f({},k.defaultOptions),{useRowspanHeaders:!0,useMultiLevelHeaders:!0});return b}(k)});p(l,"Data/Connectors/HTMLTableConnector.js",[l["Data/Connectors/DataConnector.js"],l["Core/Globals.js"],l["Data/Converters/HTMLTableConverter.js"],l["Core/Utilities.js"]],function(k,g,h,f){var e=this&&this.__extends||function(){function a(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return a(b,c)}return function(b,c){function d(){this.constructor=b}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),c=g.win,b=f.merge;g=function(a){function d(c){var e=b(d.defaultOptions,c);c=a.call(this,e)||this;c.converter=new h(e);
c.options=e;return c}e(d,a);d.prototype.load=function(a){var d=this,e=d.converter,f=d.table,g=d.options,h=g.dataModifier;g=g.table;d.emit({type:"load",detail:a,table:f,tableElement:d.tableElement});f.deleteColumns();"string"===typeof g?(d.tableID=g,g=c.document.getElementById(g)):d.tableID=g.id;d.tableElement=g||void 0;if(!d.tableElement)return d.emit({type:"loadError",detail:a,error:"HTML table not provided, or element with ID not found",table:f}),Promise.reject(Error("HTML table not provided, or element with ID not found"));
e.parse(b({tableElement:d.tableElement},d.options),a);f.setColumns(e.getTable().getColumns());return d.setModifierOptions(h).then(function(){d.emit({type:"afterLoad",detail:a,table:f,tableElement:d.tableElement});return d})};d.defaultOptions={table:""};return d}(k);k.registerType("HTMLTable",g);return g});p(l,"Data/Modifiers/ChainModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Core/Utilities.js"]],function(k,g){var h=this&&this.__extends||function(){function e(c,b){e=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return e(c,b)}return function(c,b){function a(){this.constructor=c}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(c,b);c.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)}}(),f=g.merge;g=function(e){function c(b){for(var a=[],d=1;d<arguments.length;d++)a[d-1]=arguments[d];d=e.call(this)||
this;d.chain=a;d.options=f(c.defaultOptions,b);for(var g=d.options.chain||[],h=0,l=g.length,p,y;h<l;++h)p=g[h],p.type&&(y=k.types[p.type])&&a.push(new y(p));return d}h(c,e);c.prototype.add=function(b,a){this.emit({type:"addModifier",detail:a,modifier:b});this.chain.push(b);this.emit({type:"addModifier",detail:a,modifier:b})};c.prototype.clear=function(b){this.emit({type:"clearChain",detail:b});this.chain.length=0;this.emit({type:"afterClearChain",detail:b})};c.prototype.modify=function(b,a){function d(b){var d=
e[b];f=f.then(function(b){return d.modify(b.modified,a)})}var c=this,e=this.options.reverse?this.chain.slice().reverse():this.chain.slice();b.modified===b&&(b.modified=b.clone(!1,a));for(var f=Promise.resolve(b),g=0,h=e.length;g<h;++g)d(g,h);f=f.then(function(a){b.modified.deleteColumns();b.modified.setColumns(a.modified.getColumns());return b});return f=f["catch"](function(d){c.emit({type:"error",detail:a,table:b});throw d;})};c.prototype.modifyCell=function(b,a,d,c,e){var f=this.options.reverse?
this.chain.reverse():this.chain;if(f.length){for(var g=b.clone(),h=0,m=f.length;h<m;++h)f[h].modifyCell(g,a,d,c,e),g=g.modified;b.modified=g}return b};c.prototype.modifyColumns=function(b,a,d,c){var e=this.options.reverse?this.chain.reverse():this.chain.slice();if(e.length){for(var f=b.clone(),g=0,h=e.length;g<h;++g)e[g].modifyColumns(f,a,d,c),f=f.modified;b.modified=f}return b};c.prototype.modifyRows=function(b,a,d,c){var e=this.options.reverse?this.chain.reverse():this.chain.slice();if(e.length){for(var f=
b.clone(),g=0,h=e.length;g<h;++g)e[g].modifyRows(f,a,d,c),f=f.modified;b.modified=f}return b};c.prototype.modifyTable=function(b,a){this.emit({type:"modify",detail:a,table:b});for(var d=this.options.reverse?this.chain.reverse():this.chain.slice(),c=b.modified,e=0,f=d.length,g;e<f;++e)g=d[e],c=g.modifyTable(c,a).modified;b.modified=c;this.emit({type:"afterModify",detail:a,table:b});return b};c.prototype.remove=function(b,a){var d=this.chain;this.emit({type:"removeModifier",detail:a,modifier:b});d.splice(d.indexOf(b),
1);this.emit({type:"afterRemoveModifier",detail:a,modifier:b})};c.defaultOptions={type:"Chain"};return c}(k);k.registerType("Chain",g);return g});p(l,"Data/Modifiers/InvertModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Core/Utilities.js"]],function(k,g){var h=this&&this.__extends||function(){function e(c,b){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return e(c,b)}
return function(c,b){function a(){this.constructor=c}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(c,b);c.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)}}(),f=g.merge;g=function(e){function c(b){var a=e.call(this)||this;a.options=f(c.defaultOptions,b);return a}h(c,e);c.prototype.modifyCell=function(b,a,d,c,e){var f=b.modified;a=f.getRowIndexBy("columnNames",a);"undefined"===typeof a?f.setColumns(this.modifyTable(b.clone()).getColumns(),
void 0,e):f.setCell("".concat(d),a,c,e);return b};c.prototype.modifyColumns=function(b,a,d,c){var e=b.modified,f=e.getColumn("columnNames")||[],g=b.getColumnNames(),h=b.getRowCount()!==f.length;if(!h)for(var k=0,m=g.length;k<m;++k)if(g[k]!==f[k]){h=!0;break}if(h)return this.modifyTable(b,c);g=Object.keys(a);k=0;for(m=g.length;k<m;++k){h=g[k];f=a[h];h=e.getRowIndexBy("columnNames",h)||e.getRowCount();for(var l=0,q=d,p=f.length;l<p;++l,++q)e.setCell("".concat(q),h,f[l],c)}return b};c.prototype.modifyRows=
function(b,a,d,c){var e=b.getColumnNames(),f=b.modified,g=f.getColumn("columnNames")||[],h=b.getRowCount()!==g.length;if(!h)for(var k=0,m=e.length;k<m;++k)if(e[k]!==g[k]){h=!0;break}if(h)return this.modifyTable(b,c);k=0;for(m=a.length;k<m;++k,++d)if(g=a[k],g instanceof Array)f.setColumn("".concat(d),g);else{h=0;for(var l=e.length;h<l;++h)f.setCell("".concat(d),h,g[e[h]],c)}return b};c.prototype.modifyTable=function(b,a){this.emit({type:"modify",detail:a,table:b});var d=b.modified;if(b.hasColumns(["columnNames"]))for(var c=
((b.deleteColumns(["columnNames"])||{}).columnNames||[]).map(function(a){return"".concat(a)}),e={},f=0,g=b.getRowCount(),h=void 0;f<g;++f)(h=b.getRow(f))&&(e[c[f]]=h);else{e={};f=0;g=b.getRowCount();for(h=void 0;f<g;++f)(h=b.getRow(f))&&(e["".concat(f)]=h);e.columnNames=b.getColumnNames()}d.deleteColumns();d.setColumns(e);this.emit({type:"afterModify",detail:a,table:b});return b};c.defaultOptions={type:"Invert"};return c}(k);k.registerType("Invert",g);return g});p(l,"Data/Modifiers/MathModifier.js",
[l["Data/Modifiers/DataModifier.js"],l["Data/Formula/FormulaParser.js"],l["Data/Formula/FormulaProcessor.js"]],function(k,g,h){var f=this&&this.__extends||function(){function b(a,d){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return b(a,d)}return function(a,d){function c(){this.constructor=a}if("function"!==typeof d&&null!==d)throw new TypeError("Class extends value "+String(d)+
" is not a constructor or null");b(a,d);a.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),e=this&&this.__assign||function(){e=Object.assign||function(b){for(var a,d=1,c=arguments.length;d<c;d++){a=arguments[d];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e])}return b};return e.apply(this,arguments)},c=function(b){function a(d){var c=b.call(this)||this;c.options=e(e({},a.defaultOptions),d);return c}f(a,b);a.prototype.modifyTable=function(a,b){this.emit({type:"modify",
detail:b,table:a});for(var d=this.options.alternativeSeparators,c=this.options.formulaColumns||a.getColumnNames(),e=a.modified,f=0,h=c.length,k;f<h;++f)k=c[f],0<=c.indexOf(k)&&e.setColumn(k,this.processColumn(a,k));c=this.options.columnFormulas||[];f=0;h=c.length;for(var m;f<h;++f)k=c[f],m=g.parseFormula(k.formula,d),e.setColumn(k.column,this.processColumnFormula(m,a,k.rowStart,k.rowEnd));this.emit({type:"afterModify",detail:b,table:a});return a};a.prototype.processColumn=function(a,b,c){void 0===
c&&(c=0);var d=this.options.alternativeSeparators;b=(a.getColumn(b,!0)||[]).slice(0<c?c:0);c=0;for(var e=b.length,f=[],k;c<e;++c)if(k=b[c],"string"===typeof k&&"="===k[0])try{f=""===k?f:g.parseFormula(k.substring(1),d),b[c]=h.processFormula(f,a)}catch(u){b[c]=NaN}return b};a.prototype.processColumnFormula=function(a,b,c,e){void 0===c&&(c=0);void 0===e&&(e=b.getRowCount());c=0<=c?c:0;e=0<=e?e:b.getRowCount()+e;var d=[];b=b.modified;var f=0;for(c=e-c;f<c;++f)try{d[f]=h.processFormula(a,b)}catch(B){d[f]=
NaN}finally{a=h.translateReferences(a,0,1)}return d};a.defaultOptions={type:"Math",alternativeSeparators:!1};return a}(k);k.registerType("Math",c);return c});p(l,"Data/Modifiers/RangeModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Core/Utilities.js"]],function(k,g){var h=this&&this.__extends||function(){function e(c,b){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};return e(c,
b)}return function(c,b){function a(){this.constructor=c}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(c,b);c.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)}}(),f=g.merge;g=function(e){function c(b){var a=e.call(this)||this;a.options=f(c.defaultOptions,b);return a}h(c,e);c.prototype.modifyTable=function(b,a){this.emit({type:"modify",detail:a,table:b});var c=this.options,e=c.additive,f=c.ranges;c=c.strict;
if(f.length){for(var g=b.modified,h=b.getColumns(),k=[],l=0,p=f.length,x,q;l<p;++l)if(x=f[l],!c||typeof x.minValue===typeof x.maxValue){0<l&&!e&&(g.deleteRows(),g.setRows(k),h=g.getColumns(),k=[]);q=h[x.column]||[];for(var z=0,w=q.length,r;z<w;++z){r=q[z];switch(typeof r){default:continue;case "boolean":case "number":case "string":}(!c||typeof r===typeof x.minValue)&&r>=x.minValue&&r<=x.maxValue&&(r=e?b.getRow(z):g.getRow(z))&&k.push(r)}}g.deleteRows();g.setRows(k)}this.emit({type:"afterModify",detail:a,
table:b});return b};c.defaultOptions={type:"Range",ranges:[]};return c}(k);k.registerType("Range",g);return g});p(l,"Data/Modifiers/SortModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Data/DataTable.js"],l["Core/Utilities.js"]],function(k,g,h){var f=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};return c(b,a)}return function(b,
a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),e=h.merge;h=function(c){function b(a){var d=c.call(this)||this;d.options=e(b.defaultOptions,a);return d}f(b,c);b.ascending=function(a,b){return(a||0)<(b||0)?-1:(a||0)>(b||0)?1:0};b.descending=function(a,b){return(b||0)<(a||0)?-1:(b||0)>(a||0)?1:0};b.prototype.getRowReferences=
function(a){a=a.getRows();for(var b=[],c=0,e=a.length;c<e;++c)b.push({index:c,row:a[c]});return b};b.prototype.modifyCell=function(a,b,c,e,f){var d=this.options,h=d.orderByColumn;d=d.orderInColumn;b===h&&(d?(a.modified.setCell(b,c,e),a.modified.setColumn(d,this.modifyTable(new g({columns:a.getColumns([h,d])})).modified.getColumn(d))):this.modifyTable(a,f));return a};b.prototype.modifyColumns=function(a,b,c,e){var d=this.options,f=d.orderByColumn;d=d.orderInColumn;var h=Object.keys(b);-1<h.indexOf(f)&&
(d&&b[h[0]].length?(a.modified.setColumns(b,c),a.modified.setColumn(d,this.modifyTable(new g({columns:a.getColumns([f,d])})).modified.getColumn(d))):this.modifyTable(a,e));return a};b.prototype.modifyRows=function(a,b,c,e){var d=this.options,f=d.orderByColumn;(d=d.orderInColumn)&&b.length?(a.modified.setRows(b,c),a.modified.setColumn(d,this.modifyTable(new g({columns:a.getColumns([f,d])})).modified.getColumn(d))):this.modifyTable(a,e);return a};b.prototype.modifyTable=function(a,c){var d;this.emit({type:"modify",
detail:c,table:a});var e=a.getColumnNames(),f=a.getRowCount(),g=this.getRowReferences(a),h=this.options,k=h.orderInColumn,l="asc"===h.direction?b.ascending:b.descending,p=e.indexOf(h.orderByColumn);e=a.modified;-1!==p&&g.sort(function(a,b){return l(a.row[p],b.row[p])});if(k){var q=[];for(h=0;h<f;++h)q[g[h].index]=h;e.setColumns((d={},d[k]=q,d))}else{d=[];for(h=0;h<f;++h)d.push(g[h].row);e.setRows(d,0)}this.emit({type:"afterModify",detail:c,table:a});return a};b.defaultOptions={type:"Sort",direction:"desc",
orderByColumn:"y"};return b}(k);k.registerType("Sort",h);return h});p(l,"masters/modules/data-tools.src.js",[l["Core/Globals.js"],l["Data/Connectors/DataConnector.js"],l["Data/Converters/DataConverter.js"],l["Data/DataCursor.js"],l["Data/Modifiers/DataModifier.js"],l["Data/DataPool.js"],l["Data/DataTable.js"],l["Data/Formula/Formula.js"]],function(k,g,h,f,e,c,b,a){k.DataConnector=g;k.DataConverter=h;k.DataCursor=f;k.DataModifier=e;k.DataPool=c;k.DataTable=b;k.Formula=a})});
//# sourceMappingURL=data-tools.js.map