/*
 Highcharts JS v11.1.0 (2023-09-05)

 (c) 2009-2022

 License: www.highcharts.com/license
*/
'use strict';(function(b){"object"===typeof module&&module.exports?(b["default"]=b,module.exports=b):"function"===typeof define&&define.amd?define("highcharts/modules/flowmap",["highcharts"],function(l){b(l);b.Highcharts=l;return b}):b("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function l(b,h,l,t){b.hasOwnProperty(h)||(b[h]=t.apply(null,l),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:h,module:b[h]}})))}b=b?b._modules:
{};l(b,"Series/FlowMap/FlowMapPoint.js",[b["Core/Series/SeriesRegistry.js"],b["Core/Utilities.js"]],function(b,h){({seriesTypes:{mapline:{prototype:{pointClass:b}}}}=b);const {pick:l,isString:t,isNumber:u}=h;class E extends b{constructor(){super(...arguments);this.series=this.options=void 0}isValid(){let b=!(!this.options.to||!this.options.from);[this.options.to,this.options.from].forEach(function(h){b=!!(b&&h&&(t(h)||u(l(h[0],h.lat))&&u(l(h[1],h.lon))))});return b}}return E});l(b,"Series/FlowMap/FlowMapSeries.js",
[b["Series/FlowMap/FlowMapPoint.js"],b["Core/Series/SeriesRegistry.js"],b["Core/Utilities.js"]],function(b,h,l){const {series:{prototype:{pointClass:t}},seriesTypes:{column:u,map:E,mapline:F}}=h,{addEvent:K,arrayMax:L,arrayMin:M,defined:G,extend:N,isArray:H,merge:I,pick:w,relativeLength:J}=l;class v extends F{constructor(){super(...arguments);this.centerOfPoints=this.greatestWeight=this.smallestWeight=this.points=this.options=this.data=void 0}static getLength(a,d){return Math.sqrt(a*a+d*d)}static normalize(a,
d){const b=this.getLength(a,d);return[a/b,d/b]}static markerEndPath(a,d,b,c){const f=J(c.width||0,this.getLength(d[0]-a[0],d[1]-a[1])),m=c.markerType||"arrow",[e,C]=this.normalize(d[0]-a[0],d[1]-a[1]);c=[];if("arrow"===m){let [m,g]=a;m-=e*f;g-=C*f;c.push(["L",m,g]);c.push(["L",b[0],b[1]]);[m,g]=d;m+=e*f;g+=C*f;c.push(["L",m,g])}if("mushroom"===m){let [m,g]=a,[k,n]=d;const [x,p]=b;d=(k-m)/2+m;a=(n-g)/2+g;d=2*(x-d)+d;a=2*(p-a)+a;m-=e*f;g-=C*f;c.push(["L",m,g]);k+=e*f;n+=C*f;c.push(["Q",d,a,k,n])}return c}animate(a){const d=
this.points;a||d.forEach(a=>{if(a.shapeArgs&&H(a.shapeArgs.d)&&a.shapeArgs.d.length){const c=a.shapeArgs.d,d=c[0][1],b=c[0][2];if(d&&b){const e=[];for(let a=0;a<c.length;a++){e.push([...c[a]]);for(let f=1;f<c[a].length;f++)e[a][f]=f%2?d:b}a.graphic&&(a.graphic.attr({d:e}),a.graphic.animate({d:c}))}}})}getLinkWidth(a){var d=this.options.width;const b=a.options.weight||this.options.weight;a.options.weight=b;if(d&&!b)return d;a=this.smallestWeight;d=this.greatestWeight;if(!G(b)||!a||!d)return 0;const c=
this.options.minWidth;return(b-a)*(this.options.maxWidth-c)/(d-a||1)+c}autoCurve(a,d,b,c,f,p){var e=b-a,m=c-d;a=(b-a)/2+a-f;d=(c-d)/2+d-p;e=Math.atan2(e*d-m*a,e*a+m*d);e=180*e/Math.PI;0>e&&(e=360+e);e=e*Math.PI/180;return.7*-Math.sin(e)}pointAttribs(a,b){b=E.prototype.pointAttribs.call(this,a,b);b.fill=w(a.options.fillColor,a.options.color,"none"===this.options.fillColor?null:this.options.fillColor,this.color);b["fill-opacity"]=w(a.options.fillOpacity,this.options.fillOpacity);b["stroke-width"]=w(a.options.lineWidth,
this.options.lineWidth,1);a.options.opacity&&(b.opacity=a.options.opacity);return b}translate(){!this.chart.hasRendered||!this.isDirtyData&&this.hasRendered||(this.processData(),this.generatePoints());const a=[];let b=0,m=0;this.points.forEach(c=>{const d=this.chart,p=d.mapView,e=c.options,h=()=>{c.series.isDirty=!0},l=a=>{a=d.get(a);if(a instanceof t&&a.plotX&&a.plotY)return K(a,"update",h),{x:a.plotX,y:a.plotY}},g=a=>H(a)?{lon:a[0],lat:a[1]}:a;let k,n;"string"===typeof e.from?k=l(e.from):"object"===
typeof e.from&&p&&(k=p.lonLatToPixels(g(e.from)));"string"===typeof e.to?n=l(e.to):"object"===typeof e.to&&p&&(n=p.lonLatToPixels(g(e.to)));c.fromPos=k;c.toPos=n;k&&n&&(b+=(k.x+n.x)/2,m+=(k.y+n.y)/2);w(c.options.weight,this.options.weight)&&a.push(w(c.options.weight,this.options.weight))});this.smallestWeight=M(a);this.greatestWeight=L(a);this.centerOfPoints={x:b/this.points.length,y:m/this.points.length};this.points.forEach(a=>{this.getLinkWidth(a)?(a.fromPos&&(a.plotX=a.fromPos.x,a.plotY=a.fromPos.y),
a.shapeType="path",a.shapeArgs=this.getPointShapeArgs(a),a.color=w(a.options.color,a.series.color)):a.shapeArgs={d:[]}})}getPointShapeArgs(a){const {fromPos:b,toPos:m}=a;if(!b||!m)return{};var c=this.getLinkWidth(a)/2,f=a.options,p=I(this.options.markerEnd,f.markerEnd),e=w(f.growTowards,this.options.growTowards);const h=b.x||0,l=b.y||0;var g=m.x||0,k=m.y||0;f=w(f.curveFactor,this.options.curveFactor);var n=p&&p.enabled&&p.height||0;G(f)||(f=this.autoCurve(h,l,g,k,this.centerOfPoints.x,this.centerOfPoints.y));
if(n){n=J(n,4*c);var x=.5*(g-h);var q=.5*(k-l);var r=h+x,t=l+q;const a=x;x=q;q=-a;let [b,d]=v.normalize(r+x*f-g,t+q*f-k);b*=n;d*=n;g+=b;k+=d}r=.5*(g-h);n=.5*(k-l);t=h+r;x=l+n;q=r;r=n;n=-q;let [u,D]=v.normalize(r,n);q=1+.25*Math.sqrt(f*f);u*=c*q;D*=c*q;r=t+r*f;f=x+n*f;let [A,B]=v.normalize(r-h,f-l);q=A;A=B*c;B=-q*c;let [y,z]=v.normalize(r-g,f-k);q=y;y=-z*c;z=q*c;e&&(A/=c,B/=c,u/=4,D/=4);c={d:[["M",h-A,l-B],["Q",r-u,f-D,g-y,k-z],["L",g+y,k+z],["Q",r+u,f+D,h+A,l+B],["Z"]]};p&&p.enabled&&c.d&&(p=v.markerEndPath([g-
y,k-z],[g+y,k+z],[m.x,m.y],p),c.d.splice(2,0,...p));k=a.options.from;g=a.options.to;p=k.lat;k=k.lon;e=g.lat;g=g.lon;p&&k&&(a.options.from=`${+p}, ${+k}`);e&&g&&(a.options.to=`${+e}, ${+g}`);return c}}v.defaultOptions=I(F.defaultOptions,{animation:!0,dataLabels:{enabled:!1},fillOpacity:.5,markerEnd:{enabled:!0,height:"40%",width:"40%",markerType:"arrow"},width:1,maxWidth:25,minWidth:5,lineWidth:void 0,tooltip:{headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.options.from} \u2192 {point.options.to}: <b>{point.options.weight}</b>"}});
N(v.prototype,{pointClass:b,pointArrayMap:["from","to","weight"],drawPoints:u.prototype.drawPoints,useMapGeometry:!0});h.registerSeriesType("flowmap",v);"";return v});l(b,"masters/modules/flowmap.src.js",[],function(){})});
//# sourceMappingURL=flowmap.js.map