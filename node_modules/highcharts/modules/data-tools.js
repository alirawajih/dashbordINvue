/*
 Highcharts JS v11.1.0 (2023-09-05)

 Highcharts

 (c) 2010-2023 Highsoft AS

 License: www.highcharts.com/license
*/
'use strict';var r=r||{};r.scope={};r.arrayIteratorImpl=function(e){var l=0;return function(){return l<e.length?{done:!1,value:e[l++]}:{done:!0}}};r.arrayIterator=function(e){return{next:r.arrayIteratorImpl(e)}};r.ASSUME_ES5=!1;r.ASSUME_NO_NATIVE_MAP=!1;r.ASSUME_NO_NATIVE_SET=!1;r.SIMPLE_FROUND_POLYFILL=!1;r.ISOLATE_POLYFILLS=!1;
r.defineProperty=r.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,l,n){if(e==Array.prototype||e==Object.prototype)return e;e[l]=n.value;return e};r.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var l=0;l<e.length;++l){var n=e[l];if(n&&n.Math==Math)return n}throw Error("Cannot find global object");};r.global=r.getGlobal(this);
r.SYMBOL_PREFIX="jscomp_symbol_";r.initSymbol=function(){r.initSymbol=function(){};r.global.Symbol||(r.global.Symbol=r.Symbol)};r.SymbolClass=function(e,l){this.$jscomp$symbol$id_=e;r.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};r.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
r.Symbol=function(){function e(n){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new r.SymbolClass(r.SYMBOL_PREFIX+(n||"")+"_"+l++,n)}var l=0;return e}();
r.initSymbolIterator=function(){r.initSymbol();var e=r.global.Symbol.iterator;e||(e=r.global.Symbol.iterator=r.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[e]&&r.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return r.iteratorPrototype(r.arrayIteratorImpl(this))}});r.initSymbolIterator=function(){}};
r.initSymbolAsyncIterator=function(){r.initSymbol();var e=r.global.Symbol.asyncIterator;e||(e=r.global.Symbol.asyncIterator=r.global.Symbol("Symbol.asyncIterator"));r.initSymbolAsyncIterator=function(){}};r.iteratorPrototype=function(e){r.initSymbolIterator();e={next:e};e[r.global.Symbol.iterator]=function(){return this};return e};
r.iteratorFromArray=function(e,l){r.initSymbolIterator();e instanceof String&&(e+="");var n=0,c={next:function(){if(n<e.length){var h=n++;return{value:l(h,e[h]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};r.polyfills={};r.propertyToPolyfillSymbol={};r.POLYFILL_PREFIX="$jscp$";r.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");
r.polyfill=function(e,l,n,c){l&&(r.ISOLATE_POLYFILLS?r.polyfillIsolated(e,l,n,c):r.polyfillUnisolated(e,l,n,c))};r.polyfillUnisolated=function(e,l){var n=r.global;e=e.split(".");for(var c=0;c<e.length-1;c++){var h=e[c];h in n||(n[h]={});n=n[h]}e=e[e.length-1];c=n[e];l=l(c);l!=c&&null!=l&&r.defineProperty(n,e,{configurable:!0,writable:!0,value:l})};
r.polyfillIsolated=function(e,l,n){var c=e.split(".");e=1===c.length;var h=c[0];h=!e&&h in r.polyfills?r.polyfills:r.global;for(var g=0;g<c.length-1;g++){var b=c[g];b in h||(h[b]={});h=h[b]}c=c[c.length-1];n=r.IS_SYMBOL_NATIVE&&"es6"===n?h[c]:null;l=l(n);null!=l&&(e?r.defineProperty(r.polyfills,c,{configurable:!0,writable:!0,value:l}):l!==n&&(r.propertyToPolyfillSymbol[c]=r.IS_SYMBOL_NATIVE?r.global.Symbol(c):r.POLYFILL_PREFIX+c,c=r.propertyToPolyfillSymbol[c],r.defineProperty(h,c,{configurable:!0,
writable:!0,value:l})))};r.polyfill("Array.prototype.values",function(e){return e?e:function(){return r.iteratorFromArray(this,function(e,n){return n})}},"es8","es3");
(function(e){"object"===typeof module&&module.exports?(e["default"]=e,module.exports=e):"function"===typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(l){e(l);e.Highcharts=l;return e}):e("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(e){function l(e,c,h,g){e.hasOwnProperty(c)||(e[c]=g.apply(null,h),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:c,module:e[c]}})))}e=e?e._modules:{};l(e,
"Data/Modifiers/DataModifier.js",[e["Core/Utilities.js"]],function(e){const {addEvent:c,fireEvent:h,merge:g}=e;class b{benchmark(a,f){const d=[],b=this,p=()=>{b.modifyTable(a);b.emit({type:"afterBenchmarkIteration"})},{iterations:q}=g({iterations:1},f);b.on("afterBenchmarkIteration",()=>{d.length===q?b.emit({type:"afterBenchmark",results:d}):p()});var c=0,v=0;b.on("modify",()=>{c=window.performance.now()});b.on("afterModify",()=>{v=window.performance.now();d.push(v-c)});p();return d}emit(a){h(this,
a.type,a)}modify(a,f){const d=this;return new Promise((b,p)=>{a.modified===a&&(a.modified=a.clone(!1,f));try{b(d.modifyTable(a,f))}catch(q){d.emit({type:"error",detail:f,table:a}),p(q)}})}modifyCell(a){return this.modifyTable(a)}modifyColumns(a){return this.modifyTable(a)}modifyRows(a){return this.modifyTable(a)}on(a,f){return c(this,a,f)}}(function(a){a.types={};a.registerType=function(f,d){return!!f&&!a.types[f]&&!!(a.types[f]=d)}})(b||(b={}));return b});l(e,"Data/DataTable.js",[e["Core/Utilities.js"]],
function(e){const {addEvent:c,fireEvent:h,uniqueKey:g}=e;class b{static isNull(a){if(a===b.NULL)return!0;if(a instanceof Array){if(!a.length)return!1;for(let f=0,d=a.length;f<d;++f)if(null!==a[f])return!1}else{const f=Object.keys(a);if(!f.length)return!1;for(let d=0,b=f.length;d<b;++d)if(null!==a[f[d]])return!1}return!0}constructor(a={}){this.aliases={};this.autoId=!a.id;this.columns={};this.id=a.id||g();this.modified=this;this.rowCount=0;this.versionTag=g();var f=a.columns||{},d=Object.keys(f);const b=
this.columns;let p=0;for(let a=0,k=d.length,c,g;a<k;++a)g=d[a],c=f[g].slice(),b[g]=c,p=Math.max(p,c.length);for(let a=0,f=d.length;a<f;++a)b[d[a]].length=p;this.rowCount=p;a=a.aliases||{};f=Object.keys(a);d=this.aliases;for(let b=0,k=f.length,p;b<k;++b)p=f[b],d[p]=a[p]}clone(a,f){var d={};this.emit({type:"cloneTable",detail:f});a||(d.aliases=this.aliases,d.columns=this.columns);this.autoId||(d.id=this.id);d=new b(d);a||(d.versionTag=this.versionTag);this.emit({type:"afterCloneTable",detail:f,tableClone:d});
return d}deleteColumnAlias(a){const f=this.aliases[a],d=this.modifier;f&&(delete this.aliases[a],d&&d.modifyColumns(this,{[f]:Array(this.rowCount)},0));return f}deleteColumns(a,f){const d=this.columns,b={},p={},q=this.modifier,c=this.rowCount;a=a||Object.keys(d);if(a.length){this.emit({type:"deleteColumns",columnNames:a,detail:f});for(let f=0,k=a.length,q,g;f<k;++f){g=a[f];if(q=d[g])b[g]=q,p[g]=Array(c);delete d[g]}Object.keys(d).length||(this.rowCount=0);q&&q.modifyColumns(this,p,0,f);this.emit({type:"afterDeleteColumns",
columns:b,columnNames:a,detail:f});return b}}deleteRows(a,f=1,d){const b=[],p=[],q=this.modifier;this.emit({type:"deleteRows",detail:d,rowCount:f,rowIndex:a||0});"undefined"===typeof a&&(a=0,f=this.rowCount);if(0<f&&a<this.rowCount){const d=this.columns,k=Object.keys(d);for(let q=0,c=k.length,g,y;q<c;++q){g=d[k[q]];y=g.splice(a,f);q||(this.rowCount=g.length);for(let a=0,d=y.length;a<d;++a)b[a]=b[a]||[],b[a][q]=y[a];p.push(Array(c))}}q&&q.modifyRows(this,p,a||0,d);this.emit({type:"afterDeleteRows",
detail:d,rowCount:f,rowIndex:a||0,rows:b});return b}emit(a){switch(a.type){case "afterDeleteColumns":case "afterDeleteRows":case "afterSetCell":case "afterSetColumns":case "afterSetRows":this.versionTag=g()}h(this,a.type,a)}getCell(a,f){a=this.aliases[a]||a;if(a=this.columns[a])return a[f]}getCellAsBoolean(a,f){a=this.aliases[a]||a;a=this.columns[a];return!(!a||!a[f])}getCellAsNumber(a,f,d){a=this.aliases[a]||a;f=(a=this.columns[a])&&a[f];switch(typeof f){case "boolean":return f?1:0;case "number":return isNaN(f)&&
!d?null:f}f=parseFloat(`${f}`);return isNaN(f)&&!d?null:f}getCellAsString(a,f){a=this.aliases[a]||a;a=this.columns[a];return`${a&&a[f]}`}getColumn(a,f){return this.getColumns([a],f)[a]}getColumnAliases(){const a=this.aliases,f=Object.keys(a),d={};for(let b=0,p=f.length,q;b<p;++b)q=f[b],d[q]=a[q];return d}getColumnAsNumbers(a,f){var d=this.columns;a=this.aliases[a]||a;const b=d[a];d=[];if(b){const k=b.length;if(f)for(f=0;f<k;++f)d.push(this.getCellAsNumber(a,f,!0));else{for(let a=0,d;a<k;++a){d=b[a];
if("number"===typeof d)return b.slice();if(null!==d&&"undefined"!==typeof d)break}for(f=0;f<k;++f)d.push(this.getCellAsNumber(a,f))}}return d}getColumnNames(){return Object.keys(this.columns)}getColumns(a,b){const d=this.aliases,f=this.columns,p={};a=a||Object.keys(f);for(let k=0,c=a.length,g,e;k<c;++k)e=a[k],(g=f[d[e]||e])&&(p[e]=b?g:g.slice());return p}getModifier(){return this.modifier}getRow(a,b){return this.getRows(a,1,b)[0]}getRowCount(){return this.rowCount}getRowIndexBy(a,b,d){a=this.aliases[a]||
a;if(a=this.columns[a])if(b=a.indexOf(b,d),-1!==b)return b}getRowObject(a,b){return this.getRowObjects(a,1,b)[0]}getRowObjects(a=0,b=this.rowCount-a,d){const f=this.aliases,p=this.columns,q=Array(b);d=d||Object.keys(p);for(let k=a,c=0,g=Math.min(this.rowCount,a+b),e,m;k<g;++k,++c){m=q[c]={};for(const a of d)e=p[f[a]||a],m[a]=e?e[k]:void 0}return q}getRows(a=0,b=this.rowCount-a,d){const f=this.aliases,p=this.columns,c=Array(b);d=d||Object.keys(p);for(let k=a,q=0,g=Math.min(this.rowCount,a+b),e,m;k<
g;++k,++q){m=c[q]=[];for(const a of d)e=p[f[a]||a],m.push(e?e[k]:void 0)}return c}getVersionTag(){return this.versionTag}hasColumns(a){const b=this.aliases,d=this.columns;for(let f=0,p=a.length,c;f<p;++f)if(c=a[f],!d[c]&&!b[c])return!1;return!0}hasRowWith(a,b){a=this.aliases[a]||a;return(a=this.columns[a])?-1!==a.indexOf(b):!1}on(a,b){return c(this,a,b)}renameColumn(a,b){const d=this.columns;if(d[a]){if(a!==b){const f=this.aliases;f[b]&&delete f[b];d[b]=d[a];delete d[a]}return!0}return!1}setCell(a,
b,d,k){const f=this.columns,c=this.modifier;a=this.aliases[a]||a;let g=f[a];g&&g[b]===d||(this.emit({type:"setCell",cellValue:d,columnName:a,detail:k,rowIndex:b}),g||(g=f[a]=Array(this.rowCount)),b>=this.rowCount&&(this.rowCount=b+1),g[b]=d,c&&c.modifyCell(this,a,b,d),this.emit({type:"afterSetCell",cellValue:d,columnName:a,detail:k,rowIndex:b}))}setColumn(a,b=[],d=0,k){this.setColumns({[a]:b},d,k)}setColumnAlias(a,b){const d=this.aliases;return d[a]?!1:(d[a]=b,!0)}setColumns(a,b,d){const f=this.columns,
p=this.modifier;var c="undefined"===typeof b;const g=Object.keys(a);this.emit({type:"setColumns",columns:a,columnNames:g,detail:d,rowIndex:b});for(let d=0,k=g.length,p,q;d<k;++d)if(q=g[d],p=a[q],q=this.aliases[q]||q,c)f[q]=p.slice(),this.rowCount=p.length;else{const a=f[q]?f[q]:f[q]=Array(this.rowCount);for(let d=b||0,f=p.length;d<f;++d)a[d]=p[d];this.rowCount=Math.max(this.rowCount,a.length)}c=Object.keys(f);for(let a=0,b=c.length;a<b;++a)f[c[a]].length=this.rowCount;p&&p.modifyColumns(this,a,b||
0);this.emit({type:"afterSetColumns",columns:a,columnNames:g,detail:d,rowIndex:b})}setModifier(a,b){const d=this;d.emit({type:"setModifier",detail:b,modifier:a,modified:d.modified});d.modified=d;d.modifier=a;return(a?a.modify(d):Promise.resolve(d)).then(d=>{d.emit({type:"afterSetModifier",detail:b,modifier:a,modified:d.modified});return d})["catch"](b=>{d.emit({type:"setModifierError",error:b,modifier:a,modified:d.modified});throw b;})}setRow(a,b,d){this.setRows([a],b,d)}setRows(a,f=this.rowCount,
d){var k=this.aliases;const p=this.columns,c=Object.keys(p),g=this.modifier,e=a.length;this.emit({type:"setRows",detail:d,rowCount:e,rowIndex:f,rows:a});for(let d=0,g=f,q;d<e;++d,++g)if(q=a[d],q===b.NULL)for(let a=0,b=c.length;a<b;++a)p[c[a]][g]=null;else if(q instanceof Array)for(let a=0,b=c.length;a<b;++a)p[c[a]][g]=q[a];else{const a=Object.keys(q);for(let b=0,d=a.length,f;b<d;++b)f=a[b],f=k[f]||f,p[f]||(p[f]=Array(g+1)),p[f][g]=q[f]}k=f+e;if(k>this.rowCount){this.rowCount=k;for(let a=0,b=c.length;a<
b;++a)p[c[a]].length=k}g&&g.modifyRows(this,a,f);this.emit({type:"afterSetRows",detail:d,rowCount:e,rowIndex:f,rows:a})}}b.NULL={};"";return b});l(e,"Data/Connectors/DataConnector.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,c,h){const {addEvent:g,fireEvent:b,merge:a,pick:f}=h;class d{constructor(a={}){this.table=new c(a.dataTable);this.metadata=a.metadata||{columns:{}}}get polling(){return!!this.polling}describeColumn(b,d){const f=this.metadata.columns;
f[b]=a(f[b]||{},d)}describeColumns(a){const b=Object.keys(a);let d;for(;"string"===typeof(d=b.pop());)this.describeColumn(d,a[d])}emit(a){b(this,a.type,a)}getColumnOrder(){const a=this.metadata.columns,b=Object.keys(a||{});if(b.length)return b.sort((b,d)=>f(a[b].index,0)-f(a[d].index,0))}getSortedColumns(a){return this.table.getColumns(this.getColumnOrder(a))}load(){b(this,"afterLoad",{table:this.table});return Promise.resolve(this)}on(a,b){return g(this,a,b)}save(){b(this,"saveError",{table:this.table});
return Promise.reject(Error("Not implemented"))}setColumnOrder(a){for(let b=0,d=a.length;b<d;++b)this.describeColumn(a[b],{index:b})}setModifierOptions(a){const b=a&&e.types[a.type];return this.table.setModifier(b?new b(a):void 0).then(()=>this)}startPolling(a=1E3){const b=this;window.clearTimeout(b._polling);b._polling=window.setTimeout(()=>b.load()["catch"](a=>b.emit({type:"loadError",error:a,table:b.table})).then(()=>{b._polling&&b.startPolling(a)}),a)}stopPolling(){window.clearTimeout(this._polling);
delete this._polling}whatIs(a){return this.metadata.columns[a]}}(function(a){a.types={};a.registerType=function(b,d){return!!b&&!a.types[b]&&!!(a.types[b]=d)}})(d||(d={}));return d});l(e,"Data/Converters/DataConverter.js",[e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,c){const {addEvent:h,fireEvent:g,isNumber:b,merge:a}=c;class f{constructor(b){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(a){return a?Date.UTC(+a[1],a[3]-1,+a[4]):
NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[3]-1,+a[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[1]-1,+a[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){if(!a)return NaN;let b=+a[4];b=b>(new Date).getFullYear()-2E3?b+1900:b+2E3;return Date.UTC(b,a[3]-1,+a[1])},alternative:"mm/dd/YY"},
"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){return a?Date.UTC(+a[4]+2E3,a[1]-1,+a[3]):NaN}}};b=a(f.defaultOptions,b);let d=b.decimalPoint;if("."===d||","===d)this.decimalRegExp=new RegExp("^(-?[0-9]+)"+("."===d?"\\.":",")+"([0-9]+)$");this.options=b}asBoolean(a){return"boolean"===typeof a?a:"string"===typeof a?""!==a&&"0"!==a&&"false"!==a:!!this.asNumber(a)}asDate(a){if("string"===typeof a)a=this.parseDate(a);else if("number"!==typeof a){if(a instanceof
Date)return a;a=this.parseDate(this.asString(a))}return new Date(a)}asGuessedType(a){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(a)].call(this,a)}asNumber(a){if("number"===typeof a)return a;if("boolean"===typeof a)return a?1:0;if("string"===typeof a){const b=this.decimalRegExp;-1<a.indexOf(" ")&&(a=a.replace(/\s+/g,""));if(b){if(!b.test(a))return NaN;a=a.replace(b,"$1.$2")}return parseFloat(a)}return a instanceof Date?a.getDate():a?a.getRowCount():NaN}asString(a){return""+
a}deduceDateFormat(a,b,f){const d=[],k=[];let p="YYYY/mm/dd",c,g=[],e=0,h=!1,n,u;if(!b||b>a.length)b=a.length;for(;e<b;e++)if("undefined"!==typeof a[e]&&a[e]&&a[e].length)for(c=a[e].trim().replace(/[-\.\/]/g," ").split(" "),g=["","",""],u=0;u<c.length;u++)u<g.length&&(n=parseInt(c[u],10))&&(k[u]=!k[u]||k[u]<n?n:k[u],"undefined"!==typeof d[u]?d[u]!==n&&(d[u]=!1):d[u]=n,31<n?g[u]=100>n?"YY":"YYYY":12<n&&31>=n?(g[u]="dd",h=!0):g[u].length||(g[u]="mm"));if(h){for(u=0;u<d.length;u++)!1!==d[u]?12<k[u]&&
"YY"!==g[u]&&"YYYY"!==g[u]&&(g[u]="YY"):12<k[u]&&"mm"===g[u]&&(g[u]="dd");3===g.length&&"dd"===g[1]&&"dd"===g[2]&&(g[2]="YY");p=g.join("/")}f&&(this.options.dateFormat=p);return p}emit(a){g(this,a.type,a)}export(){this.emit({type:"exportError",columns:[],headers:[]});throw Error("Not implemented");}getTable(){throw Error("Not implemented");}guessType(a){var d="string";if("string"===typeof a){var f=this.trim(`${a}`),c=this.decimalRegExp;f=this.trim(f,!0);c&&(f=c.test(f)?f.replace(c,"$1.$2"):"");c=
parseFloat(f);+f===c?a=c:(d=this.parseDate(a),d=b(d)?"Date":"string")}"number"===typeof a&&(d=31536E6<a?"Date":"number");return d}on(a,b){return h(this,a,b)}parse(){this.emit({type:"parseError",columns:[],headers:[]});throw Error("Not implemented");}parseDate(a,f){var d=this.options;let c=f||d.dateFormat;f=NaN;let k,g;if(d.parseDate)f=d.parseDate(a);else{if(c)(d=this.dateFormats[c])||(d=this.dateFormats["YYYY/mm/dd"]),(g=a.match(d.regex))&&(f=d.parser(g));else for(k in this.dateFormats)if(d=this.dateFormats[k],
g=a.match(d.regex)){f=d.parser(g);break}g||(g=Date.parse(a),"object"===typeof g&&null!==g&&g.getTime?f=g.getTime()-6E4*g.getTimezoneOffset():b(g)&&(f=g-6E4*(new Date(g)).getTimezoneOffset(),-1===a.indexOf("2001")&&2001===(new Date(f)).getFullYear()&&(f=NaN)))}return f}trim(a,b){"string"===typeof a&&(a=a.replace(/^\s+|\s+$/g,""),b&&/^[0-9\s]+$/.test(a)&&(a=a.replace(/\s/g,"")));return a}}f.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,
firstRowAsNames:!0,switchRowsAndColumns:!1};(function(a){a.getTableFromColumns=function(a=[],b=[]){const d=new e;for(let f=0,g=Math.max(b.length,a.length);f<g;++f)d.setColumn(b[f]||`${f}`,a[f]);return d}})(f||(f={}));return f});l(e,"Data/DataCursor.js",[],function(){class e{constructor(c={}){this.emittingRegister=[];this.listenerMap={};this.stateMap=c}addListener(c,e,g){c=this.listenerMap[c]=this.listenerMap[c]||{};(c[e]=c[e]||[]).push(g);return this}buildEmittingTag(c){return("position"===c.cursor.type?
[c.table.id,c.cursor.column,c.cursor.row,c.cursor.state,c.cursor.type]:[c.table.id,c.cursor.columns,c.cursor.firstRow,c.cursor.lastRow,c.cursor.state,c.cursor.type]).join("\x00")}emitCursor(c,h,g,b,a){const f="object"===typeof h?h:g;g="object"===typeof b?b:g;const d="string"===typeof h?h:void 0;var k=c.id;h=f.state;if(h=this.listenerMap[k]&&this.listenerMap[k][h]){k=this.stateMap[k]=this.stateMap[k]||{};const p=k[f.state]||[];if(a||!0===b)p.length||(k[f.state]=p),-1===e.getIndex(f,p)&&p.push(f);c=
{cursor:f,cursors:p,table:c};g&&(c.event=g);d&&(c.group=d);b=this.emittingRegister;a=this.buildEmittingTag(c);if(0<=b.indexOf(a))return this;try{this.emittingRegister.push(a);for(let a=0,b=h.length;a<b;++a)h[a].call(this,c)}finally{c=this.emittingRegister.indexOf(a),0<=c&&this.emittingRegister.splice(c,1)}}return this}remitCursor(c,h){if(c=this.stateMap[c]&&this.stateMap[c][h.state])h=e.getIndex(h,c),0<=h&&c.splice(h,1);return this}removeListener(c,e,g){(c=this.listenerMap[c]&&this.listenerMap[c][e])&&
(g=c.indexOf(g))&&c.splice(g,1);return this}}(function(c){function e(g,b){var a,f,d,c;if("range"===g.type)return g;b={type:"range",firstRow:null!==(f=null!==(a=g.row)&&void 0!==a?a:b&&b.firstRow)&&void 0!==f?f:0,lastRow:null!==(c=null!==(d=g.row)&&void 0!==d?d:b&&b.lastRow)&&void 0!==c?c:Number.MAX_VALUE,state:g.state};"undefined"!==typeof g.column&&(b.columns=[g.column]);return b}c.getIndex=function(c,b){if("position"===c.type)for(let a,f=0,d=b.length;f<d;++f){if(a=b[f],"position"===a.type&&a.state===
c.state&&a.column===c.column&&a.row===c.row)return f}else{const a=JSON.stringify(c.columns);for(let f,d=0,g=b.length;d<g;++d)if(f=b[d],"range"===f.type&&f.state===c.state&&f.firstRow===c.firstRow&&f.lastRow===c.lastRow&&JSON.stringify(f.columns)===a)return d}return-1};c.isEqual=function(c,b){return"position"===c.type&&"position"===b.type?c.column===b.column&&c.row===b.row&&c.state===b.state:"range"===c.type&&"range"===b.type?c.firstRow===b.firstRow&&c.lastRow===b.lastRow&&JSON.stringify(c.columns)===
JSON.stringify(b.columns):!1};c.isInRange=function(c,b){"position"===b.type&&(b=e(b));"position"===c.type&&(c=e(c,b));const a=c.columns,f=b.columns;return c.firstRow>=b.firstRow&&c.lastRow<=b.lastRow&&(!a||!f||a.every(a=>0<=f.indexOf(a)))};c.toPositions=function(c){if("position"===c.type)return[c];const b=c.columns||[],a=[],f=c.state;for(let d=c.firstRow,k=c.lastRow;d<k;++d)if(b.length)for(let c=0,k=b.length;c<k;++c)a.push({type:"position",column:b[c],row:d,state:f});else a.push({type:"position",
row:d,state:f});return a};c.toRange=e})(e||(e={}));"";return e});l(e,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}});l(e,"Data/DataPool.js",[e["Data/Connectors/DataConnector.js"],e["Data/DataPoolDefaults.js"],e["Core/Utilities.js"]],function(e,c,h){class g{constructor(b=c){b.connectors=b.connectors||[];this.connectors={};this.options=b;this.waiting={}}emit(b){h.fireEvent(this,b.type,b)}getConnector(b){var a=this.connectors[b];if(a)return Promise.resolve(a);let f=this.waiting[b];if(f)return new Promise(a=>
{f.push(a)});this.waiting[b]=f=[];if(a=this.getConnectorOptions(b))return this.loadConnector(a).then(a=>{delete this.waiting[b];window.setTimeout(()=>{for(let b=0,d=f.length;b<d;++b)f[b](a)},1);return a});throw Error(`Connector not found. (${b})`);}getConnectorIds(){const b=this.options.connectors,a=[];for(let f=0,d=b.length;f<d;++f)a.push(b[f].id);return a}getConnectorOptions(b){const a=this.options.connectors;for(let f=0,d=a.length;f<d;++f)if(a[f].id===b)return a[f]}getConnectorTable(b){return this.getConnector(b).then(a=>
a.table)}loadConnector(b){return new Promise((a,f)=>{this.emit({type:"load",options:b});const d=e.types[b.type];if(!d)throw Error(`Connector type not found. (${b.type})`);(new d(b.options)).load().then(d=>{this.emit({type:"afterLoad",options:b});this.connectors[b.id]=d;a(d)})["catch"](f)})}on(b,a){return h.addEvent(this,b,a)}setConnectorOptions(b){const a=this.options.connectors;this.emit({type:"setConnectorOptions",options:b});for(let f=0,d=a.length;f<d;++f)if(a[f].id===b.id){a.splice(f,1);break}a.push(b);
this.emit({type:"afterSetConnectorOptions",options:b})}}return g});l(e,"Data/Formula/FormulaParser.js",[],function(){function e(a){let b=0;for(let d=0,f=a.length,c,k=1;d<f;++d)if(c=a[d],"("===c)b||(k=d+1),++b;else if(")"===c&&(--b,!b))return a.substring(k,d);if(0<b)throw a=Error("Incomplete parantheses."),a.name="FormulaParseError",a;return""}function c(a){let b=-1;for(let d=0,f=a.length,c,k=!1;d<f;++d)if(c=a[d],"\\"===c)k=!k;else if(k)k=!1;else if('"'===c)if(0>b)b=d;else return a.substring(b+1,d);
a=Error("Incomplete string.");a.name="FormulaParseError";throw a;}function h(d,f){var c;if(c=d.match(v)){d=""===c[2]||"["===c[2][0];f=""===c[1]||"["===c[1][0];var k=""===c[4]||"["===c[4][0],g=""===c[3]||"["===c[3][0];c={type:"range",beginColumn:d?parseInt(c[2].substring(1,-1)||"0",10):parseInt(c[2],10)-1,beginRow:f?parseInt(c[1].substring(1,-1)||"0",10):parseInt(c[1],10)-1,endColumn:k?parseInt(c[4].substring(1,-1)||"0",10):parseInt(c[4],10)-1,endRow:g?parseInt(c[3].substring(1,-1)||"0",10):parseInt(c[3],
10)-1};d&&(c.beginColumnRelative=!0);f&&(c.beginRowRelative=!0);k&&(c.endColumnRelative=!0);g&&(c.endRowRelative=!0);return c}if(c=d.match(y))return d="$"!==c[1][0],f="$"!==c[2][0],k="$"!==c[3][0],g="$"!==c[4][0],c={type:"range",beginColumn:a(d?c[1]:c[1].substring(1))-1,beginRow:parseInt(f?c[2]:c[2].substring(1),10)-1,endColumn:a(k?c[3]:c[3].substring(1))-1,endRow:parseInt(g?c[4]:c[4].substring(1),10)-1},d&&(c.beginColumnRelative=!0),f&&(c.beginRowRelative=!0),k&&(c.endColumnRelative=!0),g&&(c.endRowRelative=
!0),c;c=b(d,f);return 1===c.length&&"string"!==typeof c[0]?c[0]:c}function g(a,b){const d=[],f=b?";":",";let k=0,g="";for(let p=0,e=a.length,q;p<e;++p)if(q=a[p],q===f&&!k&&g)d.push(h(g,b)),g="";else if('"'!==q||k||g)" "!==q&&(g+=q,"("===q?++k:")"===q&&--k);else{const b=c(a.substring(p));d.push(b);p+=b.length+1}!k&&g&&d.push(h(g,b));return d}function b(y,h){const n=h?k:d,v=[];var m;let t=("="===y[0]?y.substring(1):y).trim();for(;t;)if(m=t.match(w)){var x=""===m[2]||"["===m[2][0],A=""===m[1]||"["===
m[1][0],B={type:"reference",column:x?parseInt(m[2].substring(1,-1)||"0",10):parseInt(m[2],10)-1,row:A?parseInt(m[1].substring(1,-1)||"0",10):parseInt(m[1],10)-1};x&&(B.columnRelative=!0);A&&(B.rowRelative=!0);v.push(B);t=t.substring(m[0].length).trim()}else if(m=t.match(l))x="$"!==m[1][0],A="$"!==m[2][0],B={type:"reference",column:a(x?m[1]:m[1].substring(1))-1,row:parseInt(A?m[2]:m[2].substring(1),10)-1},x&&(B.columnRelative=!0),A&&(B.rowRelative=!0),v.push(B),t=t.substring(m[0].length).trim();else if(m=
t.match(q))v.push(m[0]),t=t.substring(m[0].length).trim();else if(m=t.match(f))v.push("TRUE"===m[0]),t=t.substring(m[0].length).trim();else if(m=t.match(n))v.push(parseFloat(m[0])),t=t.substring(m[0].length).trim();else if('"'===t[0])m=c(t),v.push(m.substring(1,-1)),t=t.substring(m.length+2).trim();else if(m=t.match(p))t=t.substring(m[1].length).trim(),x=e(t),v.push({type:"function",name:m[1],args:g(x,h)}),t=t.substring(x.length+2).trim();else{if("("===t[0]&&(m=e(t))){v.push(b(m,h));t=t.substring(m.length+
2).trim();continue}h=y.length-t.length;y=Error("Unexpected character `"+y.substring(h,h+1)+"` at position "+(h+1)+". (`..."+y.substring(h-5,h+6)+"...`)");y.name="FormulaParseError";throw y;}return v}function a(a){let b=0;for(let d=0,f=a.length,c,k=a.length-1;d<f;++d)c=a.charCodeAt(d),65<=c&&90>=c&&(b+=(c-64)*Math.pow(26,k)),--k;return b}const f=/^(?:FALSE|TRUE)/,d=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,k=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,p=/^([A-Z][A-Z\d\.]*)\(/,q=/^(?:[+\-*\/^<=>]|<=|=>)/,y=/^(\$?[A-Z]+)(\$?\d+):(\$?[A-Z]+)(\$?\d+)/,
v=/^R(\d*|\[\d+\])C(\d*|\[\d+\]):R(\d*|\[\d+\])C(\d*|\[\d+\])/,l=/^(\$?[A-Z]+)(\$?\d+)(?![:C])/,w=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!:)/;return{parseFormula:b}});l(e,"Data/Formula/FormulaTypes.js",[],function(){const e="+ - * / ^ = < <= > >=".split(" ");return{isFormula:function(c){return c instanceof Array},isFunction:function(c){return"object"===typeof c&&!(c instanceof Array)&&"function"===c.type},isOperator:function(c){return"string"===typeof c&&0<=e.indexOf(c)},isRange:function(c){return"object"===
typeof c&&!(c instanceof Array)&&"range"===c.type},isReference:function(c){return"object"===typeof c&&!(c instanceof Array)&&"reference"===c.type},isValue:function(c){return"boolean"===typeof c||"number"===typeof c||"string"===typeof c}}});l(e,"Data/Formula/FormulaProcessor.js",[e["Data/Formula/FormulaTypes.js"]],function(e){function c(a){switch(typeof a){case "boolean":return a?E:u;case "string":return C;case "number":return a;default:return NaN}}function h(a){return"string"===typeof a?a.toLowerCase().replace(z,
"\x00"):a}function g(a){switch(typeof a){case "boolean":return a?1:0;case "string":return parseFloat(a.replace(",","."));case "number":return a;default:return NaN}}function b(a,b,d){switch(a){case "=":return h(b)===h(d);case "<":return typeof b===typeof d?h(b)<h(d):c(b)<c(d);case "<=":return typeof b===typeof d?h(b)<=h(d):c(b)<=c(d);case ">":return typeof b===typeof d?h(b)>h(d):c(b)>c(d);case ">=":return typeof b===typeof d?h(b)>=h(d):c(b)>=c(d)}b=g(b);d=g(d);switch(a){case "+":a=b+d;break;case "-":a=
b-d;break;case "*":a=b*d;break;case "/":a=b/d;break;case "^":a=Math.pow(b,d);break;default:return NaN}return a%1?Math.round(1E9*a)/1E9:a}function a(a,b){return l(a)?a:w(a)?b&&f(a,b)||[]:v(a)?p(a,b):k(y(a)?a:[a],b)}function f(a,b){const d=b.getColumnNames().slice(a.beginColumn,a.endColumn+1),f=[];for(let c=0,k=d.length,g;c<k;++c){const k=b.getColumn(d[c],!0)||[];for(let p=a.beginRow,e=a.endRow+1;p<e;++p)g=k[p],"string"===typeof g&&"="===g[0]&&b!==b.modified&&(g=b.modified.getCell(d[c],p)),f.push(l(g)?
g:NaN)}return f}function d(a,b){const d=b.getColumnNames()[a.column];if(d){const f=b.getCell(d,a.row);return"string"===typeof f&&"="===f[0]&&b!==b.modified?(a=b.modified.getCell(d,a.row),l(a)?a:NaN):l(f)?f:NaN}return NaN}function k(a,f){let c;for(let g=0,e=a.length,q,h,t,w;g<e;++g)if(q=a[g],n(q))h=q;else if(l(q)?w=q:y(q)?w=k(a,f):v(q)?(t=p(q,f),w=l(t)?t:NaN):m(q)&&(w=f&&d(q,f)),"undefined"!==typeof w){if("undefined"===typeof c)c=h?b(h,0,w):w;else if(h){const d=a[g+1];n(d)&&D[d]>D[h]&&(w=b(d,w,k(a.slice(g+
2))),g=e);c=b(h,c,w)}else return NaN;w=h=void 0}return l(c)?c:NaN}function p(a,b){const d=A[a.name];if(d)try{return d(a.args,b)}catch(F){return NaN}a=Error(`Function "${a.name}" not found.`);a.name="FormulaProcessError";throw a;}function q(a,b=0,d=0){for(let f=0,c=a.length,k;f<c;++f)k=a[f],k instanceof Array?q(k):v(k)?q(k.args):w(k)?(k.beginColumnRelative&&(k.beginColumn+=b),k.beginRowRelative&&(k.beginRow+=d),k.endColumnRelative&&(k.endColumn+=b),k.endRowRelative&&(k.endRow+=d)):m(k)&&(k.columnRelative&&
(k.column+=b),k.rowRelative&&(k.row+=d));return a}const {isFormula:y,isFunction:v,isOperator:n,isRange:w,isReference:m,isValue:l}=e,z=/ */,u=Number.MAX_VALUE/1.000000000001,C=Number.MAX_VALUE/1.000000000002,E=Number.MAX_VALUE,D={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},A={},B=/^[A-Z][A-Z\.]*$/;return{asNumber:g,getArgumentValue:a,getArgumentsValues:function(b,d){const f=[];for(let c=0,k=b.length;c<k;++c)f.push(a(b[c],d));return f},getRangeValues:f,getReferenceValue:d,processFormula:k,
processorFunctions:A,registerProcessorFunction:function(a,b){return B.test(a)&&!A[a]&&!!(A[a]=b)},translateReferences:q}});l(e,"Data/Formula/Functions/ABS.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,b){c=h(c[0],b);switch(typeof c){case "number":return Math.abs(c);case "object":b=[];for(let a=0,f=c.length,d;a<f;++a){d=c[a];if("number"!==typeof d)return NaN;b.push(Math.abs(d))}return b;default:return NaN}}const {getArgumentValue:h}=e;e.registerProcessorFunction("ABS",c);return c});
l(e,"Data/Formula/Functions/AND.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(g,b){for(let a=0,f=g.length,d;a<f;++a)if(d=h(g[a],b),!d||"object"===typeof d&&!c(d,b))return!1;return!0}const {getArgumentValue:h}=e;e.registerProcessorFunction("AND",c);return c});l(e,"Data/Formula/Functions/AVERAGE.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,b){c=h(c,b);let a=b=0;for(let f=0,d=c.length,k;f<d;++f)switch(k=c[f],typeof k){case "number":isNaN(k)||(++b,a+=k);break;
case "object":for(let d=0,f=k.length,c;d<f;++d)c=k[d],"number"!==typeof c||isNaN(c)||(++b,a+=c)}return b?a/b:0}const {getArgumentsValues:h}=e;e.registerProcessorFunction("AVERAGE",c);return c});l(e,"Data/Formula/Functions/AVERAGEA.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,b){let a=0,f=0;for(let d=0,k=c.length,e;d<k;++d)switch(e=h(c[d],b),typeof e){case "boolean":++a;f+=e?1:0;continue;case "number":isNaN(e)||(++a,f+=e);continue;case "string":++a;continue;default:for(let b=
0,d=e.length,c;b<d;++b)switch(c=e[b],typeof c){case "boolean":++a;f+=c?1:0;continue;case "number":isNaN(c)||(++a,f+=c);continue;case "string":++a}}return a?f/a:0}const {getArgumentValue:h}=e;e.registerProcessorFunction("AVERAGEA",c);return c});l(e,"Data/Formula/Functions/COUNT.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(h,g){h=e.getArgumentsValues(h,g);let b=0;for(let a=0,f=h.length,d;a<f;++a)switch(d=h[a],typeof d){case "number":isNaN(d)||++b;break;case "object":b+=c(d,g)}return b}
e.registerProcessorFunction("COUNT",c);return c});l(e,"Data/Formula/Functions/COUNTA.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(h,g){h=e.getArgumentsValues(h,g);let b=0;for(let a=0,f=h.length,d;a<f;++a){d=h[a];switch(typeof d){case "number":if(isNaN(d))continue;break;case "object":b+=c(d,g);continue;case "string":if(!d)continue}++b}return b}e.registerProcessorFunction("COUNTA",c);return c});l(e,"Data/Formula/Functions/IF.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,
b){return h(c[0],b)?h(c[1],b):h(c[2],b)}const {getArgumentValue:h}=e;e.registerProcessorFunction("IF",c);return c});l(e,"Data/Formula/Functions/ISNA.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,b){c=h(c[0],b);return"number"!==typeof c||isNaN(c)}const {getArgumentValue:h}=e;e.registerProcessorFunction("ISNA",c);return c});l(e,"Data/Formula/Functions/MAX.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(e,b){e=h(e,b);b=Number.NEGATIVE_INFINITY;for(let a=0,f=
e.length,d;a<f;++a)switch(d=e[a],typeof d){case "number":d>b&&(b=d);break;case "object":d=c(d),d>b&&(b=d)}return isFinite(b)?b:0}const {getArgumentsValues:h}=e;e.registerProcessorFunction("MAX",c);return c});l(e,"Data/Formula/Functions/MEDIAN.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,g){const b=[];c=e.getArgumentsValues(c,g);for(let a=0,f=c.length,d;a<f;++a)switch(d=c[a],typeof d){case "number":isNaN(d)||b.push(d);break;case "object":for(let a=0,f=d.length,c;a<f;++a)c=d[a],
"number"!==typeof c||isNaN(c)||b.push(c)}c=b.length;if(!c)return NaN;g=Math.floor(c/2);return c%2?b[g]:(b[g-1]+b[g])/2}e.registerProcessorFunction("MEDIAN",c);return c});l(e,"Data/Formula/Functions/MIN.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(e,b){e=h(e,b);b=Number.POSITIVE_INFINITY;for(let a=0,f=e.length,d;a<f;++a)switch(d=e[a],typeof d){case "number":d<b&&(b=d);break;case "object":d=c(d),d<b&&(b=d)}return isFinite(b)?b:0}const {getArgumentsValues:h}=e;e.registerProcessorFunction("MIN",
c);return c});l(e,"Data/Formula/Functions/MOD.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,b){let a=h(c[0],b);c=h(c[1],b);"object"===typeof a&&(a=a[0]);"object"===typeof c&&(c=c[0]);return"number"!==typeof a||"number"!==typeof c||0===c?NaN:a%c}const {getArgumentValue:h}=e;e.registerProcessorFunction("MOD",c);return c});l(e,"Data/Formula/Functions/MODE.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(b,a){const f={};b=e.getArgumentsValues(b,a);for(let a=0,
c=b.length,e;a<c;++a)switch(e=b[a],typeof e){case "number":isNaN(e)||(f[e]=(f[e]||0)+1);break;case "object":for(let a=0,b=e.length,d;a<b;++a)d=e[a],"number"!==typeof d||isNaN(d)||(f[d]=(f[d]||0)+1)}return f}function h(b,a){b=c(b,a);a=Object.keys(b);if(!a.length)return NaN;let f=[parseFloat(a[0])],d=b[a[0]];for(let c=1,e=a.length,g,h;c<e;++c)g=a[c],h=b[g],d<h?(f=[parseFloat(g)],d=h):d===h&&f.push(parseFloat(g));return 1<d?f:NaN}function g(b,a){b=c(b,a);a=Object.keys(b);if(!a.length)return NaN;let f=
parseFloat(a[0]),d=b[a[0]];for(let c=1,e=a.length,g,h,v;c<e;++c)g=a[c],v=b[g],d<v?(f=parseFloat(g),d=v):d===v&&(h=parseFloat(g),f>h&&(f=h,d=v));return 1<d?f:NaN}e.registerProcessorFunction("MODE",g);e.registerProcessorFunction("MODE.MULT",h);e.registerProcessorFunction("MODE.SNGL",g);return{MULT:h,SNGL:g}});l(e,"Data/Formula/Functions/NOT.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,b){c=h(c[0],b);"object"===typeof c&&(c=c[0]);switch(typeof c){case "boolean":case "number":return!c}return NaN}
const {getArgumentValue:h}=e;e.registerProcessorFunction("NOT",c);return c});l(e,"Data/Formula/Functions/OR.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(e,b){for(let a=0,f=e.length,d;a<f;++a)if(d=h(e[a],b),"object"===typeof d){if(c(d,b))return!0}else if(d)return!0;return!1}const {getArgumentValue:h}=e;e.registerProcessorFunction("OR",c);return c});l(e,"Data/Formula/Functions/PRODUCT.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(e,b){e=h(e,b);let a=1,f=!1;
for(let d=0,k=e.length,p;d<k;++d)switch(p=e[d],typeof p){case "number":isNaN(p)||(f=!0,a*=p);break;case "object":f=!0,a*=c(p,b)}return f?a:0}const {getArgumentsValues:h}=e;e.registerProcessorFunction("PRODUCT",c);return c});l(e,"Data/Formula/Functions/SUM.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(h,g){h=e.getArgumentsValues(h,g);let b=0;for(let a=0,f=h.length,d;a<f;++a)switch(d=h[a],typeof d){case "number":isNaN(d)||(b+=d);break;case "object":b+=c(d,g)}return b}e.registerProcessorFunction("SUM",
c);return c});l(e,"Data/Formula/Functions/XOR.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){function c(c,b){for(let a=0,f=c.length,d,e;a<f;++a)switch(e=h(c[a],b),typeof e){case "boolean":case "number":if("undefined"===typeof d)d=!!e;else if(!!e!==d)return!0;break;case "object":for(let a=0,b=e.length,f;a<b;++a)switch(f=e[a],typeof f){case "boolean":case "number":if("undefined"===typeof d)d=!!f;else if(!!f!==d)return!0}}return!1}const {getArgumentValue:h}=e;e.registerProcessorFunction("XOR",
c);return c});l(e,"Data/Formula/Formula.js",[e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"],e["Data/Formula/FormulaTypes.js"]],function(e,c,h){return Object.assign(Object.assign(Object.assign({},e),c),h)});l(e,"Data/Converters/CSVConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,c){const {merge:h}=c;class g extends e{constructor(b){b=h(g.defaultOptions,b);super(b);this.columns=[];this.headers=[];this.dataTypes=[];this.options=b}export(b,
a=this.options){const {useLocalDecimalPoint:f,lineDelimiter:d}=a;var c=!1!==this.options.firstRowAsNames;let {decimalPoint:e,itemDelimiter:g}=a;e||(e=","!==g&&f?(1.1).toLocaleString()[1]:".");g||(g=","===e?";":",");a=b.getSortedColumns(a.usePresentationOrder);const h=Object.keys(a),v=[],t=h.length,w=[];c&&v.push(h.map(a=>`"${a}"`).join(g));for(c=0;c<t;c++){var m=h[c];const d=a[m],f=d.length;m=b.whatIs(m);let k;m&&(k=m.dataType);for(m=0;m<f;m++){var n=d[m];w[m]||(w[m]=[]);"string"===k?n='"'+n+'"':
"number"===typeof n?n=String(n).replace(".",e):"string"===typeof n&&(n=`"${n}"`);w[m][c]=n;if(c===t-1){for(n=c;2<w[m].length&&void 0===w[m][n];)w[m].pop(),n--;v.push(w[m].join(g))}}}return v.join(d)}parse(b,a){var f=this.dataTypes;b=h(this.options,b);const {beforeParse:d,lineDelimiter:c,firstRowAsNames:e,itemDelimiter:g}=b;let {csv:y,startRow:v,endRow:t}=b;this.columns=[];this.emit({type:"parse",columns:this.columns,detail:a,headers:this.headers});y&&d&&(y=d(y));if(y){b=y.replace(/\r\n|\r/g,"\n").split(c||
"\n");if(!v||0>v)v=0;if(!t||t>=b.length)t=b.length-1;g||(this.guessedItemDelimiter=this.guessDelimiter(b));if(e){var n=b[0].split(g||this.guessedItemDelimiter||",");for(var m=0;m<n.length;m++)n[m]=n[m].trim().replace(/^["']|["']$/g,"");this.headers=n;v++}m=0;for(n=v;n<=t;n++)"#"===b[n][0]?m++:this.parseCSVRow(b[n],n-v-m);f.length&&f[0].length&&"date"===f[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(let a=0,d=this.columns.length;a<d;++a){f=this.columns[a];for(let d=
0,c=f.length;d<c;++d)f[d]&&"string"===typeof f[d]&&(b=this.asGuessedType(f[d]),b instanceof Date&&(b=b.getTime()),this.columns[a][d]=b)}}this.emit({type:"afterParse",columns:this.columns,detail:a,headers:this.headers})}parseCSVRow(b,a){const c=this,d=c.columns||[],e=c.dataTypes,{startColumn:g,endColumn:q}=c.options,h=c.options.itemDelimiter||c.guessedItemDelimiter;let {decimalPoint:v}=c.options;v&&v!==h||(v=c.guessedDecimalPoint||".");let n=0,l="",m="",x=0,z=0;const u=a=>{e.length<z+1&&e.push([a]);
e[z][e[z].length-1]!==a&&e[z].push(a)},C=()=>{if(g>x||x>q)++x,m="";else{"string"===typeof m?!isNaN(parseFloat(m))&&isFinite(m)?(m=parseFloat(m),u("number")):isNaN(Date.parse(m))?u("string"):(m=m.replace(/\//g,"-"),u("date")):u("number");d.length<z+1&&d.push([]);if("number"!==typeof m&&"number"!==c.guessType(m)&&v){const a=m;m=m.replace(v,".");"number"!==c.guessType(m)&&(m=a)}d[z][a]=m;m="";++z;++x}};if(b.trim().length&&"#"!==b.trim()[0]){for(;n<b.length;n++){l=b[n];if("#"===l&&!/^#[0-F]{3,3}|[0-F]{6,6}/i.test(b.substring(n))){C();
return}if('"'===l)for(l=b[++n];n<b.length&&'"'!==l;)m+=l,l=b[++n];else l===h?C():m+=l}C()}}guessDelimiter(b){let a=0,c=0;const d={",":0,";":0,"\t":0},e=b.length;for(let f=0;f<e;f++){let e=!1,k,g,p,h="";if(13<f)break;const m=b[f];for(let b=0;b<m.length;b++){k=m[b];g=m[b+1];p=m[b-1];if("#"===k)break;if('"'===k)if(e){if('"'!==p&&'"'!==g){for(;" "===g&&b<m.length;)g=m[++b];"undefined"!==typeof d[g]&&d[g]++;e=!1}}else e=!0;else"undefined"!==typeof d[k]?(h=h.trim(),isNaN(Date.parse(h))?!isNaN(Number(h))&&
isFinite(Number(h))||d[k]++:d[k]++,h=""):h+=k;","===k&&c++;"."===k&&a++}}b=d[";"]>d[","]?";":",";this.guessedDecimalPoint=a>c?".":",";return b}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}g.defaultOptions=Object.assign(Object.assign({},e.defaultOptions),{lineDelimiter:"\n"});return g});l(e,"Data/Connectors/CSVConnector.js",[e["Data/Converters/CSVConverter.js"],e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"]],function(e,c,h){const {merge:g}=h;class b extends c{constructor(a){a=
g(b.defaultOptions,a);super(a);this.converter=new e(a);this.options=a;a.enablePolling&&this.startPolling(1E3*Math.max(a.dataRefreshRate||0,1))}load(a){const b=this,d=b.converter,c=b.table,{csv:e,csvURL:g,dataModifier:h}=b.options;b.emit({type:"load",csv:e,detail:a,table:c});c.deleteRows();return Promise.resolve(e?e:g?fetch(g||"").then(a=>a.text()):"").then(a=>{a&&(d.parse({csv:a}),c.setColumns(d.getTable().getColumns()));return b.setModifierOptions(h).then(()=>a)}).then(d=>{b.emit({type:"afterLoad",
csv:d,detail:a,table:c});return b})["catch"](d=>{b.emit({type:"loadError",detail:a,error:d,table:c});throw d;})}}b.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0};c.registerType("CSV",b);return b});l(e,"Data/Converters/JSONConverter.js",[e["Data/Converters/DataConverter.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,c,h){const {merge:g,isArray:b}=h;class a extends e{constructor(b){b=g(a.defaultOptions,b);super(b);this.columns=[];this.headers=
[];this.dataTypes=[];this.options=b;this.table=new c}parse(a){a=g(this.options,a);const {beforeParse:d,orientation:c,firstRowAsNames:f,columnNames:e}=a;if(a=a.data)if(d&&(a=d(a)),a=a.slice(),"columns"===c)for(let b=0,d=a.length;b<d;b++){var h=a[b];if(!(h instanceof Array))break;f?this.headers.push(`${h.shift()}`):e&&this.headers.push(e[b]);this.table.setColumn(this.headers[b]||b.toString(),h)}else if("rows"===c){f?this.headers=a.shift():e&&(this.headers=e);for(let d=0,c=a.length;d<c;d++)if(h=a[d],
b(h))for(let a=0,b=h.length;a<b;a++)this.columns.length<a+1&&this.columns.push([]),this.columns[a].push(h[a]),this.table.setCell(this.headers[a]||d.toString(),d,h[a]);else this.table.setRows([h],d)}}getTable(){return this.table}}a.defaultOptions=Object.assign(Object.assign({},e.defaultOptions),{data:[],orientation:"columns"});return a});l(e,"Data/Connectors/JSONConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"],e["Data/Converters/JSONConverter.js"]],function(e,c,h){const {merge:g}=
c;class b extends e{constructor(a){a=g(b.defaultOptions,a);super(a);this.converter=new h(a);this.options=a;a.enablePolling&&this.startPolling(1E3*Math.max(a.dataRefreshRate||0,1))}load(a){const b=this,d=b.converter,c=b.table,{data:e,dataUrl:g,dataModifier:h}=b.options;b.emit({type:"load",data:e,detail:a,table:c});c.deleteRows();return Promise.resolve(g?fetch(g).then(a=>a.json()):e?e:[]).then(a=>{a&&(d.parse({data:a}),c.setColumns(d.getTable().getColumns()));return b.setModifierOptions(h).then(()=>
a)}).then(d=>{b.emit({type:"afterLoad",data:d,detail:a,table:c});return b})["catch"](d=>{b.emit({type:"loadError",detail:a,error:d,table:c});throw d;})}}b.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"};e.registerType("JSON",b);return b});l(e,"Data/Converters/GoogleSheetsConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,c){const {merge:h,uniqueKey:g}=c;class b extends e{constructor(a){a=h(b.defaultOptions,a);super(a);
this.columns=[];this.header=[];this.options=a}parse(a,b){a=h(this.options,a);const d=(a.json&&a.json.values||[]).map(a=>a.slice());if(0===d.length)return!1;this.header=[];this.columns=[];this.emit({type:"parse",columns:this.columns,detail:b,headers:this.header});this.columns=d;let c;for(let b=0,f=d.length;b<f;b++){c=d[b];this.header[b]=a.firstRowAsNames?`${c.shift()}`:g();for(let a=0,d=c.length;a<d;++a)if(c[a]&&"string"===typeof c[a]){let d=this.asGuessedType(c[a]);d instanceof Date&&(d=d.getTime());
this.columns[b][a]=d}}this.emit({type:"afterParse",columns:this.columns,detail:b,headers:this.header})}getTable(){return e.getTableFromColumns(this.columns,this.header)}}b.defaultOptions=Object.assign({},e.defaultOptions);return b});l(e,"Data/Connectors/GoogleSheetsConnector.js",[e["Data/Connectors/DataConnector.js"],e["Data/Converters/GoogleSheetsConverter.js"],e["Core/Utilities.js"]],function(e,c,h){const {merge:g,pick:b}=h;class a extends e{constructor(b){b=g(a.defaultOptions,b);super(b);this.converter=
new c(b);this.options=b}load(b){const d=this,c=d.converter,f=d.table,{dataModifier:e,dataRefreshRate:g,enablePolling:h,firstRowAsNames:n,googleAPIKey:l,googleSpreadsheetKey:m}=d.options,x=a.buildFetchURL(l,m,d.options);d.emit({type:"load",detail:b,table:f,url:x});f.deleteColumns();return fetch(x).then(a=>a.json()).then(a=>{if("object"===typeof a&&a&&"object"===typeof a.error&&a.error&&"number"===typeof a.error.code&&"string"===typeof a.error.message&&"string"===typeof a.error.status)throw Error(a.error.message);
c.parse({firstRowAsNames:n,json:a});f.setColumns(c.getTable().getColumns());return d.setModifierOptions(e)}).then(()=>{d.emit({type:"afterLoad",detail:b,table:f,url:x});h&&setTimeout(()=>d.load(),1E3*Math.max(g||0,1));return d})["catch"](a=>{d.emit({type:"loadError",detail:b,error:a,table:f});throw a;})}}a.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};(function(a){function d(a={}){const {endColumn:d,endRow:c,googleSpreadsheetRange:f,
startColumn:e,startRow:k}=a;return f||("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e||0]||"A")+(Math.max(k||0,0)+1)+":"+("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[b(d,25)]||"Z")+(c?Math.max(c,0):"Z")}a.buildFetchURL=function(a,b,c={}){return`https://sheets.googleapis.com/v4/spreadsheets/${b}/values/`+(c.onlyColumnNames?"A1:Z1":d(c))+"?alt=json"+(c.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false"+`&key=${a}`};a.buildQueryRange=d})(a||
(a={}));e.registerType("GoogleSheets",a);return a});l(e,"Data/Converters/HTMLTableConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,c){const {merge:h}=c;class g extends e{constructor(b){b=h(g.defaultOptions,b);super(b);this.columns=[];this.headers=[];this.options=b;b.tableElement&&(this.tableElement=b.tableElement,this.tableElementID=b.tableElement.id)}export(b,a=this.options){var c=!1!==a.firstRowAsNames,d=a.useMultiLevelHeaders,e=b.getSortedColumns(a.usePresentationOrder);
const g=Object.keys(e);b=[];const h=g.length,n=[];var l="";if(c)if(l=[],d){for(var t of g)d=(e[t].shift()||"").toString(),l.push(d);l=this.getTableHeaderHTML(g,l,a)}else l=this.getTableHeaderHTML(void 0,g,a);for(t=0;t<h;t++){d=e[g[t]];c=d.length;for(let a=0;a<c;a++){let c=d[a];n[a]||(n[a]=[]);"string"!==typeof c&&"number"!==typeof c&&"undefined"!==typeof c&&(c=(c||"").toString());n[a][t]=this.getCellHTMLFromValue(t?"td":"th",null,t?"":'scope="row"',c);t===h-1&&b.push("<tr>"+n[a].join("")+"</tr>")}}e=
"";a.tableCaption&&(e='<caption class="highcharts-table-caption">'+a.tableCaption+"</caption>");return"<table>"+e+l+"<tbody>"+b.join("")+"</tbody></table>"}getCellHTMLFromValue(b,a,c,d,e){let f=d;a="text"+(a?" "+a:"");"number"===typeof f?(f=f.toString(),","===e&&(f=f.replace(".",e)),a="number"):d||(f="",a="empty");return"<"+b+(c?" "+c:"")+' class="'+a+'">'+f+"</"+b+">"}getTableHeaderHTML(b=[],a=[],c=this.options){const {useMultiLevelHeaders:d,useRowspanHeaders:e}=c;c.useLocalDecimalPoint&&(1.1).toLocaleString();
c="<thead>";let f=0,g=a&&a.length;var h;let n=0;if(h=d&&b&&a){a:if(h=b.length,a.length===h){for(;--h;)if(b[h]!==a[h]){h=!1;break a}h=!0}else h=!1;h=!h}if(h){for(c+="<tr>";f<g;++f){h=b[f];var l=b[f+1];h===l?++n:n?(c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(n+1)+'"',h),n=0):(h===a[f]?e?(l=2,delete a[f]):(l=1,a[f]=""):l=1,c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<l?' valign="top" rowspan="'+l+'"':""),h))}c+="</tr>"}if(a){c+=
"<tr>";f=0;for(g=a.length;f<g;++f)"undefined"!==typeof a[f]&&(c+=this.getCellHTMLFromValue("th",null,'scope="col"',a[f]));c+="</tr>"}return c+"</thead>"}parse(b,a){const c=[],d=[];var e=h(this.options,b);const {endRow:g,startColumn:q,endColumn:l,firstRowAsNames:n}=e;b=e.tableElement||this.tableElement;if(b instanceof HTMLElement){this.tableElement=b;this.tableElementID=b.id;this.emit({type:"parse",columns:this.columns,detail:a,headers:this.headers});b=b.getElementsByTagName("tr");var t=b.length,w=
0;({startRow:e}=e);if(n&&t){var m=b[0].children,x=m.length;for(var z=q;z<x&&!(z>l);z++){var u=m[z];"TD"!==u.tagName&&"TH"!==u.tagName||d.push(u.innerHTML)}e++}for(;w<t;){if(w>=e&&w<=g)for(m=b[w].children,x=m.length,z=0;z<x;){const a=z-q,b=c[a];u=m[z];if(("TD"===u.tagName||"TH"===u.tagName)&&z>=q&&z<=l)for(c[a]||(c[a]=[]),u=this.asGuessedType(u.innerHTML),u instanceof Date&&(u=u.getTime()),c[a][w-e]=u,u=1;w-e>=u&&void 0===b[w-e-u];)b[w-e-u]=null,u++;z++}w++}this.columns=c;this.headers=d;this.emit({type:"afterParse",
columns:c,detail:a,headers:d})}else this.emit({type:"parseError",columns:c,detail:a,headers:d,error:"Not a valid HTML Table"})}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}g.defaultOptions=Object.assign(Object.assign({},e.defaultOptions),{useRowspanHeaders:!0,useMultiLevelHeaders:!0});return g});l(e,"Data/Connectors/HTMLTableConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Globals.js"],e["Data/Converters/HTMLTableConverter.js"],e["Core/Utilities.js"]],function(e,
c,h,g){const {win:b}=c,{merge:a}=g;class f extends e{constructor(b){b=a(f.defaultOptions,b);super(b);this.converter=new h(b);this.options=b}load(c){const d=this,e=d.converter,f=d.table,{dataModifier:g,table:h}=d.options;d.emit({type:"load",detail:c,table:f,tableElement:d.tableElement});f.deleteColumns();let l;"string"===typeof h?(d.tableID=h,l=b.document.getElementById(h)):(l=h,d.tableID=l.id);d.tableElement=l||void 0;if(!d.tableElement)return d.emit({type:"loadError",detail:c,error:"HTML table not provided, or element with ID not found",
table:f}),Promise.reject(Error("HTML table not provided, or element with ID not found"));e.parse(a({tableElement:d.tableElement},d.options),c);f.setColumns(e.getTable().getColumns());return d.setModifierOptions(g).then(()=>{d.emit({type:"afterLoad",detail:c,table:f,tableElement:d.tableElement});return d})}}f.defaultOptions={table:""};e.registerType("HTMLTable",f);return f});l(e,"Data/Modifiers/ChainModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,c){const {merge:h}=
c;class g extends e{constructor(b,...a){super();this.chain=a;this.options=h(g.defaultOptions,b);b=this.options.chain||[];for(let c=0,d=b.length,g,h;c<d;++c)g=b[c],g.type&&(h=e.types[g.type])&&a.push(new h(g))}add(b,a){this.emit({type:"addModifier",detail:a,modifier:b});this.chain.push(b);this.emit({type:"addModifier",detail:a,modifier:b})}clear(b){this.emit({type:"clearChain",detail:b});this.chain.length=0;this.emit({type:"afterClearChain",detail:b})}modify(b,a){const c=this.options.reverse?this.chain.slice().reverse():
this.chain.slice();b.modified===b&&(b.modified=b.clone(!1,a));let d=Promise.resolve(b);for(let b=0,e=c.length;b<e;++b){const e=c[b];d=d.then(b=>e.modify(b.modified,a))}d=d.then(a=>{b.modified.deleteColumns();b.modified.setColumns(a.modified.getColumns());return b});return d=d["catch"](c=>{this.emit({type:"error",detail:a,table:b});throw c;})}modifyCell(b,a,c,d,e){const f=this.options.reverse?this.chain.reverse():this.chain;if(f.length){let g=b.clone();for(let b=0,h=f.length;b<h;++b)f[b].modifyCell(g,
a,c,d,e),g=g.modified;b.modified=g}return b}modifyColumns(b,a,c,d){const e=this.options.reverse?this.chain.reverse():this.chain.slice();if(e.length){let f=b.clone();for(let b=0,g=e.length;b<g;++b)e[b].modifyColumns(f,a,c,d),f=f.modified;b.modified=f}return b}modifyRows(b,a,c,d){const e=this.options.reverse?this.chain.reverse():this.chain.slice();if(e.length){let f=b.clone();for(let b=0,g=e.length;b<g;++b)e[b].modifyRows(f,a,c,d),f=f.modified;b.modified=f}return b}modifyTable(b,a){this.emit({type:"modify",
detail:a,table:b});const c=this.options.reverse?this.chain.reverse():this.chain.slice();let d=b.modified;for(let b=0,e=c.length,f;b<e;++b)f=c[b],d=f.modifyTable(d,a).modified;b.modified=d;this.emit({type:"afterModify",detail:a,table:b});return b}remove(b,a){const c=this.chain;this.emit({type:"removeModifier",detail:a,modifier:b});c.splice(c.indexOf(b),1);this.emit({type:"afterRemoveModifier",detail:a,modifier:b})}}g.defaultOptions={type:"Chain"};e.registerType("Chain",g);return g});l(e,"Data/Modifiers/InvertModifier.js",
[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,c){const {merge:h}=c;class g extends e{constructor(b){super();this.options=h(g.defaultOptions,b)}modifyCell(b,a,c,d,e){const f=b.modified;a=f.getRowIndexBy("columnNames",a);"undefined"===typeof a?f.setColumns(this.modifyTable(b.clone()).getColumns(),void 0,e):f.setCell(`${c}`,a,d,e);return b}modifyColumns(b,a,c,d){const e=b.modified,f=e.getColumn("columnNames")||[];let g=b.getColumnNames(),h=b.getRowCount()!==f.length;if(!h)for(let a=
0,b=g.length;a<b;++a)if(g[a]!==f[a]){h=!0;break}if(h)return this.modifyTable(b,d);g=Object.keys(a);for(let b=0,f=g.length,h,k,p;b<f;++b){k=g[b];h=a[k];p=e.getRowIndexBy("columnNames",k)||e.getRowCount();for(let a=0,b=c,f=h.length;a<f;++a,++b)e.setCell(`${b}`,p,h[a],d)}return b}modifyRows(b,a,c,d){const e=b.getColumnNames(),f=b.modified,g=f.getColumn("columnNames")||[];let h=b.getRowCount()!==g.length;if(!h)for(let a=0,b=e.length;a<b;++a)if(e[a]!==g[a]){h=!0;break}if(h)return this.modifyTable(b,d);
for(let b=0,g=c,h=a.length,k;b<h;++b,++g)if(k=a[b],k instanceof Array)f.setColumn(`${g}`,k);else for(let a=0,b=e.length;a<b;++a)f.setCell(`${g}`,a,k[e[a]],d);return b}modifyTable(b,a){this.emit({type:"modify",detail:a,table:b});const c=b.modified;if(b.hasColumns(["columnNames"])){var d=((b.deleteColumns(["columnNames"])||{}).columnNames||[]).map(a=>`${a}`);const a={};for(let c=0,e=b.getRowCount(),f;c<e;++c)(f=b.getRow(c))&&(a[d[c]]=f);c.deleteColumns();c.setColumns(a)}else{d={};for(let a=0,c=b.getRowCount(),
e;a<c;++a)(e=b.getRow(a))&&(d[`${a}`]=e);d.columnNames=b.getColumnNames();c.deleteColumns();c.setColumns(d)}this.emit({type:"afterModify",detail:a,table:b});return b}}g.defaultOptions={type:"Invert"};e.registerType("Invert",g);return g});l(e,"Data/Modifiers/MathModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"]],function(e,c,h){class g extends e{constructor(b){super();this.options=Object.assign(Object.assign({},g.defaultOptions),
b)}modifyTable(b,a){this.emit({type:"modify",detail:a,table:b});const e=this.options.alternativeSeparators;var d=this.options.formulaColumns||b.getColumnNames();const g=b.modified;for(let a=0,c=d.length,e;a<c;++a)e=d[a],0<=d.indexOf(e)&&g.setColumn(e,this.processColumn(b,e));d=this.options.columnFormulas||[];for(let a=0,f=d.length,h,k;a<f;++a)h=d[a],k=c.parseFormula(h.formula,e),g.setColumn(h.column,this.processColumnFormula(k,b,h.rowStart,h.rowEnd));this.emit({type:"afterModify",detail:a,table:b});
return b}processColumn(b,a,e=0){const d=this.options.alternativeSeparators;a=(b.getColumn(a,!0)||[]).slice(0<e?e:0);for(let e=0,f=a.length,g=[],l="",n;e<f;++e)if(n=a[e],"string"===typeof n&&"="===n[0])try{g=l===n?g:c.parseFormula(n.substring(1),d),a[e]=h.processFormula(g,b)}catch(t){a[e]=NaN}return a}processColumnFormula(b,a,c=0,d=a.getRowCount()){c=0<=c?c:0;d=0<=d?d:a.getRowCount()+d;const e=[];a=a.modified;for(let f=0,g=d-c;f<g;++f)try{e[f]=h.processFormula(b,a)}catch(y){e[f]=NaN}finally{b=h.translateReferences(b,
0,1)}return e}}g.defaultOptions={type:"Math",alternativeSeparators:!1};e.registerType("Math",g);return g});l(e,"Data/Modifiers/RangeModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,c){const {merge:h}=c;class g extends e{constructor(b){super();this.options=h(g.defaultOptions,b)}modifyTable(b,a){this.emit({type:"modify",detail:a,table:b});const {additive:c,ranges:d,strict:e}=this.options;if(d.length){const a=b.modified;let f=b.getColumns(),g=[];for(let h=0,k=d.length,
l,m;h<k;++h)if(l=d[h],!e||typeof l.minValue===typeof l.maxValue){0<h&&!c&&(a.deleteRows(),a.setRows(g),f=a.getColumns(),g=[]);m=f[l.column]||[];for(let d=0,f=m.length,h,k;d<f;++d){h=m[d];switch(typeof h){default:continue;case "boolean":case "number":case "string":}(!e||typeof h===typeof l.minValue)&&h>=l.minValue&&h<=l.maxValue&&(k=c?b.getRow(d):a.getRow(d))&&g.push(k)}}a.deleteRows();a.setRows(g)}this.emit({type:"afterModify",detail:a,table:b});return b}}g.defaultOptions={type:"Range",ranges:[]};
e.registerType("Range",g);return g});l(e,"Data/Modifiers/SortModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,c,h){const {merge:g}=h;class b extends e{static ascending(a,b){return(a||0)<(b||0)?-1:(a||0)>(b||0)?1:0}static descending(a,b){return(b||0)<(a||0)?-1:(b||0)>(a||0)?1:0}constructor(a){super();this.options=g(b.defaultOptions,a)}getRowReferences(a){a=a.getRows();const b=[];for(let c=0,e=a.length;c<e;++c)b.push({index:c,row:a[c]});return b}modifyCell(a,
b,d,e,g){const {orderByColumn:f,orderInColumn:h}=this.options;b===f&&(h?(a.modified.setCell(b,d,e),a.modified.setColumn(h,this.modifyTable(new c({columns:a.getColumns([f,h])})).modified.getColumn(h))):this.modifyTable(a,g));return a}modifyColumns(a,b,d,e){const {orderByColumn:f,orderInColumn:g}=this.options,h=Object.keys(b);-1<h.indexOf(f)&&(g&&b[h[0]].length?(a.modified.setColumns(b,d),a.modified.setColumn(g,this.modifyTable(new c({columns:a.getColumns([f,g])})).modified.getColumn(g))):this.modifyTable(a,
e));return a}modifyRows(a,b,d,e){const {orderByColumn:f,orderInColumn:g}=this.options;g&&b.length?(a.modified.setRows(b,d),a.modified.setColumn(g,this.modifyTable(new c({columns:a.getColumns([f,g])})).modified.getColumn(g))):this.modifyTable(a,e);return a}modifyTable(a,c){this.emit({type:"modify",detail:c,table:a});var d=a.getColumnNames();const e=a.getRowCount(),f=this.getRowReferences(a),{direction:g,orderByColumn:h,orderInColumn:l}=this.options,n="asc"===g?b.ascending:b.descending,w=d.indexOf(h);
d=a.modified;-1!==w&&f.sort((a,b)=>n(a.row[w],b.row[w]));if(l){var m=[];for(var x=0;x<e;++x)m[f[x].index]=x;d.setColumns({[l]:m})}else{m=[];for(x=0;x<e;++x)m.push(f[x].row);d.setRows(m,0)}this.emit({type:"afterModify",detail:c,table:a});return a}}b.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"};e.registerType("Sort",b);return b});l(e,"masters/modules/data-tools.src.js",[e["Core/Globals.js"],e["Data/Connectors/DataConnector.js"],e["Data/Converters/DataConverter.js"],e["Data/DataCursor.js"],
e["Data/Modifiers/DataModifier.js"],e["Data/DataPool.js"],e["Data/DataTable.js"],e["Data/Formula/Formula.js"]],function(e,c,h,g,b,a,f,d){e.DataConnector=c;e.DataConverter=h;e.DataCursor=g;e.DataModifier=b;e.DataPool=a;e.DataTable=f;e.Formula=d})});
//# sourceMappingURL=data-tools.js.map